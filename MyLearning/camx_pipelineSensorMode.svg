<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1267px" preserveAspectRatio="none" style="width:1975px;height:1267px;" version="1.1" viewBox="0 0 1975 1267" width="1975px" zoomAndPan="magnify"><defs><filter height="300%" id="f1s15odgy7bzcz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="258" x="857" y="22.9951">Sensor Mode standby and active</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="968" y="39.292">Jin Lin</text><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="827.7188" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="456" y="374.75"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="420.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="875" y="433.1484"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="875" y="972.4063"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="362.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1156" y="462.2813"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1277" y="883.0078"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="304.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1441" y="491.4141"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="40.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1446" y="576.8125"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1441" y="1030.6719"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="99.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1679" y="660.0781"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="525.2578" style="stroke: #000000; stroke-width: 2.0;" width="1574" x="390" y="395.0156"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="261.0625" style="stroke: #000000; stroke-width: 2.0;" width="582" x="1372" y="506.5469"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="101.3984" style="stroke: #000000; stroke-width: 2.0;" width="307" x="1382" y="530.6797"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="56.2656" style="stroke: #000000; stroke-width: 2.0;" width="520" x="1424" y="675.2109"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="1120" x="390" y="934.2734"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="86.5313" style="stroke: #000000; stroke-width: 2.0;" width="656" x="133" y="1081.9375"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="461" x2="461" y1="84.8906" y2="1227.6016"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="880" x2="880" y1="84.8906" y2="1227.6016"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1161" x2="1161" y1="84.8906" y2="1227.6016"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1282" x2="1282" y1="84.8906" y2="1227.6016"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1446" x2="1446" y1="84.8906" y2="1227.6016"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1684" x2="1684" y1="84.8906" y2="1227.6016"/><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="400" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="407" y="69.5889">chxusecasemc</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="400" y="1226.6016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="407" y="1246.5967">chxusecasemc</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="799" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="806" y="69.5889">chxextensionmodule</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="799" y="1226.6016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="806" y="1246.5967">chxextensionmodule</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="122" x="1098" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="1105" y="69.5889">camxchicontext</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="122" x="1098" y="1226.6016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="1105" y="1246.5967">camxchicontext</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1234" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1241" y="69.5889">chxsession</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="92" x="1234" y="1226.6016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="1241" y="1246.5967">chxsession</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="1392" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1399" y="69.5889">camxsession</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="1392" y="1226.6016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1399" y="1246.5967">camxsession</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="1630" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1637" y="69.5889">camxpipeline</text><rect fill="#FEFECE" filter="url(#f1s15odgy7bzcz)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="1630" y="1226.6016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1637" y="1246.5967">camxpipeline</text><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="827.7188" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="456" y="374.75"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="420.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="875" y="433.1484"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="875" y="972.4063"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="362.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1156" y="462.2813"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1277" y="883.0078"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="304.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1441" y="491.4141"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="40.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1446" y="576.8125"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1441" y="1030.6719"/><rect fill="#FFFFFF" filter="url(#f1s15odgy7bzcz)" height="99.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1679" y="660.0781"/><polygon fill="#FBFB77" filter="url(#f1s15odgy7bzcz)" points="8,99.8906,8,320.8906,452,320.8906,452,109.8906,442,99.8906,8,99.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="442" x2="442" y1="99.8906" y2="109.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="452" x2="442" y1="109.8906" y2="109.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="14" y="116.9575">activateMode:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="22" y="132.0903">1. CHIDeactivateModeRealTimeDevices</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="18" y="147.2231"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="371" x="14" y="162.356">Here Focus on the Mode, take Chxusecasemc as example</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="18" y="177.4888"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="336" x="14" y="192.6216">//If pipeline is active and LPM says to deactivate then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="389" x="14" y="207.7544">//wait for all the inflight requests to finish and then deactivate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="18" y="222.8872"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="423" x="14" y="238.02">CHIDeactivateModeSensorStandby can be used to stream off only</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="14" y="253.1528">sensor during LPM mode. This means, IFE is not hardware is not</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="377" x="14" y="268.2856">release and still can achieve current dual camera behavior.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="18" y="283.4185"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="420" x="14" y="298.5513">CHI can use CHIDeactivateModeRealTimeDevices in case to share</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="14" y="313.6841">IFE resource between cameras.</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="461" x2="508" y1="362.0156" y2="362.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="508" x2="508" y1="362.0156" y2="375.0156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="508" y1="375.0156" y2="375.0156"/><polygon fill="#A80036" points="477,371.0156,467,375.0156,477,379.0156,473,375.0156" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="269" x="473" y="341.8169">ActivateDeactivateRealtimePipeline(</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="405" x="473" y="356.9497">deactivateMode=CHIDeactivateModeRealTimeDevices)</text><rect fill="none" height="525.2578" style="stroke: #000000; stroke-width: 2.0;" width="1574" x="390" y="395.0156"/><polygon fill="#EEEEEE" points="390,395.0156,467,395.0156,467,402.0156,457,412.0156,390,412.0156,390,395.0156" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="405" y="408.0825">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="482" y="407.2261">[pipelineIndex &lt;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="162" x="591" y="407.2261">m_numOfPhysicalDevices</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="753" y="407.2261">]</text><polygon fill="#A80036" points="863,429.1484,873,433.1484,863,437.1484,867,433.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="869" y1="433.1484" y2="433.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="192" x="473" y="428.2153">DeactivatePipeline(mode)</text><polygon fill="#A80036" points="1144,458.2813,1154,462.2813,1144,466.2813,1148,462.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="885" x2="1150" y1="462.2813" y2="462.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="252" x="892" y="457.3481">DeactivatePipeline(modeBitmask)</text><polygon fill="#A80036" points="1429,487.4141,1439,491.4141,1429,495.4141,1433,491.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1166" x2="1435" y1="491.4141" y2="491.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="256" x="1173" y="486.481">Session::StreamOff(modeBitmask)</text><rect fill="none" height="261.0625" style="stroke: #000000; stroke-width: 2.0;" width="582" x="1372" y="506.5469"/><polygon fill="#EEEEEE" points="1372,506.5469,1449,506.5469,1449,513.5469,1439,523.5469,1372,523.5469,1372,506.5469" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="1387" y="519.6138">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="1464" y="518.7573">[index&lt;m_numPipelines]</text><rect fill="none" height="101.3984" style="stroke: #000000; stroke-width: 2.0;" width="307" x="1382" y="530.6797"/><polygon fill="#EEEEEE" points="1382,530.6797,1446,530.6797,1446,537.6797,1436,547.6797,1382,547.6797,1382,530.6797" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1397" y="543.7466">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="1461" y="542.8901">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="1466" y="542.8901">IsRealTime==TRUE</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="1587" y="542.8901">]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1451" x2="1498" y1="563.9453" y2="563.9453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1498" x2="1498" y1="563.9453" y2="576.9453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1457" x2="1498" y1="576.9453" y2="576.9453"/><polygon fill="#A80036" points="1467,572.9453,1457,576.9453,1467,580.9453,1463,576.9453" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="214" x="1463" y="558.8794">SetAELockRange(index, 0, 0)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1456" x2="1498" y1="616.0781" y2="616.0781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1498" x2="1498" y1="616.0781" y2="629.0781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1451" x2="1498" y1="629.0781" y2="629.0781"/><polygon fill="#A80036" points="1461,625.0781,1451,629.0781,1461,633.0781,1457,629.0781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="1463" y="611.0122">return</text><polygon fill="#A80036" points="1667,656.0781,1677,660.0781,1667,664.0781,1671,660.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1451" x2="1673" y1="660.0781" y2="660.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="190" x="1458" y="655.145">StreamOff(modeBitmask)</text><rect fill="none" height="56.2656" style="stroke: #000000; stroke-width: 2.0;" width="520" x="1424" y="675.2109"/><polygon fill="#EEEEEE" points="1424,675.2109,1488,675.2109,1488,682.2109,1478,692.2109,1424,692.2109,1424,675.2109" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1439" y="688.2778">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="1503" y="687.4214">[PipelineStatus==</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="76" x="1623" y="687.4214">STREAM_ON</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="13" x="1703" y="687.4214">or</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="1720" y="687.4214">PARTIAL_STREAM_ON</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="1853" y="687.4214">]</text><polygon fill="#FBFB77" filter="url(#f1s15odgy7bzcz)" points="1434,697.3438,1434,722.3438,1930,722.3438,1930,707.3438,1920,697.3438,1434,697.3438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1920" x2="1920" y1="697.3438" y2="707.3438"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1930" x2="1920" y1="707.3438" y2="707.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="218" x="1440" y="714.4106">1. will call every node of this Pipe's</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="249" x="1666" y="714.4106">OnNodeStreamOff(modeBitmask)</text><polygon fill="#A80036" points="1462,755.4766,1452,759.4766,1462,763.4766,1458,759.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1456" x2="1683" y1="759.4766" y2="759.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="1468" y="754.5435">return</text><polygon fill="#A80036" points="1177,791.6094,1167,795.6094,1177,799.6094,1173,795.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1171" x2="1445" y1="795.6094" y2="795.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="1183" y="790.6763">return</text><polygon fill="#A80036" points="896,820.7422,886,824.7422,896,828.7422,892,824.7422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="890" x2="1160" y1="824.7422" y2="824.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="902" y="819.8091">return</text><polygon fill="#A80036" points="477,849.875,467,853.875,477,857.875,473,853.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="471" x2="879" y1="853.875" y2="853.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="483" y="848.9419">return</text><polygon fill="#A80036" points="1265,879.0078,1275,883.0078,1265,887.0078,1269,883.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="1271" y1="883.0078" y2="883.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="273" x="473" y="878.0747">SetPipelineDeactivate(pipelineIndex)</text><polygon fill="#A80036" points="477,908.1406,467,912.1406,477,916.1406,473,912.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="471" x2="1281" y1="912.1406" y2="912.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="483" y="907.2075">return</text><rect fill="none" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="1120" x="390" y="934.2734"/><polygon fill="#EEEEEE" points="390,934.2734,467,934.2734,467,941.2734,457,951.2734,390,951.2734,390,934.2734" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="405" y="947.3403">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="482" y="946.4839">[pipelineIndex &lt;</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="162" x="591" y="946.4839">m_numOfPhysicalDevices</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="753" y="946.4839">]</text><polygon fill="#A80036" points="863,968.4063,873,972.4063,863,976.4063,867,972.4063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="869" y1="972.4063" y2="972.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="473" y="967.4731">ActivatePipeline()</text><polygon fill="#A80036" points="477,997.5391,467,1001.5391,477,1005.5391,473,1001.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="471" x2="879" y1="1001.5391" y2="1001.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="483" y="996.606">return</text><polygon fill="#A80036" points="1429,1026.6719,1439,1030.6719,1429,1034.6719,1433,1030.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="1435" y1="1030.6719" y2="1030.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="473" y="1025.7388">SetPipelineActivateFlag()</text><polygon fill="#A80036" points="477,1055.8047,467,1059.8047,477,1063.8047,473,1059.8047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="471" x2="1445" y1="1059.8047" y2="1059.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="483" y="1054.8716">return</text><rect fill="none" height="86.5313" style="stroke: #000000; stroke-width: 2.0;" width="656" x="133" y="1081.9375"/><polygon fill="#EEEEEE" points="133,1081.9375,197,1081.9375,197,1088.9375,187,1098.9375,133,1098.9375,133,1081.9375" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="148" y="1095.0044">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="212" y="1094.1479">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="301" x="217" y="1094.1479">FALSE == m_offlinePreviewSessionCreateDone</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="518" y="1094.1479">]</text><polygon fill="#FBFB77" filter="url(#f1s15odgy7bzcz)" points="143,1104.0703,143,1159.0703,775,1159.0703,775,1114.0703,765,1104.0703,143,1104.0703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="765" x2="765" y1="1104.0703" y2="1114.0703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="775" x2="765" y1="1114.0703" y2="1114.0703"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="412" x="149" y="1121.1372">m_pOfflinePreviewSessionCreateDoneCondition-&gt;Wait()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="520" x="149" y="1136.27">wait the offline preview session create done, which should be done in defer thread</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="11" x="157" y="1151.4028">in</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="134" x="172" y="1151.4028">DeferSnapSession</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="306" y="1151.4028">, which will signal after</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="450" y="1151.4028">CreateSession(</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="561" y="1151.4028">Offline_YUV_SESSION</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="6" x="716" y="1151.4028">)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="726" y="1151.4028">Done</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="466" x2="508" y1="1201.6016" y2="1201.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="508" x2="508" y1="1201.6016" y2="1214.6016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="461" x2="508" y1="1214.6016" y2="1214.6016"/><polygon fill="#A80036" points="471,1210.6016,461,1214.6016,471,1218.6016,467,1214.6016" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="473" y="1196.5356">return</text><!--
@startuml
title Sensor Mode standby and active \n Jin Lin
participant chxusecasemc
participant chxextensionmodule
participant camxchicontext
participant chxsession
participant camxsession
participant camxpipeline

note left chxusecasemc
  activateMode:
    1. CHIDeactivateModeRealTimeDevices

  Here Focus on the Mode, take Chxusecasemc as example
  
  //If pipeline is active and LPM says to deactivate then 
  //wait for all the inflight requests to finish and then deactivate

  CHIDeactivateModeSensorStandby can be used to stream off only
  sensor during LPM mode. This means, IFE is not hardware is not
  release and still can achieve current dual camera behavior.

  CHI can use CHIDeactivateModeRealTimeDevices in case to share
  IFE resource between cameras.
end note

chxusecasemc->chxusecasemc: **ActivateDeactivateRealtimePipeline(**\n**deactivateMode=CHIDeactivateModeRealTimeDevices)**
activate chxusecasemc
  loop pipelineIndex < **m_numOfPhysicalDevices**
    chxusecasemc->chxextensionmodule: **DeactivatePipeline(mode)**
    activate chxextensionmodule
      chxextensionmodule->camxchicontext: **DeactivatePipeline(modeBitmask)**
      activate camxchicontext
        camxchicontext->camxsession: **Session::StreamOff(modeBitmask)**
        activate camxsession
          loop index<m_numPipelines
            alt **IsRealTime==TRUE**
              camxsession->camxsession: **SetAELockRange(index, 0, 0)**
              activate camxsession
              camxsession->camxsession: return
              deactivate camxsession
            end

            camxsession->camxpipeline: **StreamOff(modeBitmask)**
            activate camxpipeline
              alt PipelineStatus== **STREAM_ON** or **PARTIAL_STREAM_ON**
                note over camxpipeline
                  1. will call every node of this Pipe's  **OnNodeStreamOff(modeBitmask)**
                end note
              end
            camxpipeline->camxsession: return
            deactivate camxpipeline
          end loop
        camxsession->camxchicontext: return
        deactivate camxsession
      chxextensionmodule<-camxchicontext: return
      deactivate camxchicontext
    chxusecasemc<-chxextensionmodule: return
    deactivate chxextensionmodule

    chxusecasemc->chxsession: **SetPipelineDeactivate(pipelineIndex)**
    activate chxsession
    chxusecasemc<-chxsession: return
    deactivate chxsession
  end loop


  loop pipelineIndex < **m_numOfPhysicalDevices**
    chxusecasemc->chxextensionmodule: **ActivatePipeline()**
    activate chxextensionmodule
    chxextensionmodule->chxusecasemc: **return**
    deactivate chxextensionmodule

    chxusecasemc->camxsession: **SetPipelineActivateFlag()**
    activate camxsession
    camxsession->chxusecasemc: **return**
    deactivate camxsession
  end loop
    
  alt **FALSE == m_offlinePreviewSessionCreateDone**
    note over chxusecasemc
      <color:red>**m_pOfflinePreviewSessionCreateDoneCondition->Wait()**</color>
      wait the offline preview session create done, which should be done in defer thread
        in **DeferSnapSession**, which will signal after **CreateSession(<color:red>Offline_YUV_SESSION</color>)** Done
    end note
  end
chxusecasemc->chxusecasemc: return
deactivate chxusecasemc
@enduml

PlantUML version 1.2017.20(Mon Dec 11 16:57:05 GMT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_171-8u171-b11-0ubuntu0.16.04.1-b11
Operating System: Linux
OS Version: 4.4.0-43-Microsoft
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>