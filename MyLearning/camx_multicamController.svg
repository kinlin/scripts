<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1968px" preserveAspectRatio="none" style="width:898px;height:1968px;" version="1.1" viewBox="0 0 898 1968" width="898px" zoomAndPan="magnify"><defs><filter height="300%" id="fk80a7cw9szhu" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="257" x="275" y="26.708">camx multicam controller</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="86" x="532" y="27.6514">\n     Lin Jin</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="787" x="53" y="43.9482">1. ENABLE_SNAPSHOT_FUSION: if we capture snapshot from both camera and feeding to fusion algo</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="288.5" y="60.2451">2. ENABLE_LPM: where only one camera</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="457" x="218" y="76.542">3. SYNC_MECHANSIM: HW_SYNC, SW_SYNC(not supported)</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="298" x="297.5" y="92.8389">4. SNAPSHOT_FUSION_ZOOM_MIN/MAX</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="375" x="259" y="109.1357">5. SNAPSHOT_FUSION_LUX_IDX_THRESHOLD(1.0)</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="869" x="12" y="125.4326">6. SNAPSHOT_FUSION_FOCUS_DIST_CM_MIN(15) if focus dist lower then thres, snapshot fusion will be disabled</text><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="892.8203" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="335" y="245.1641"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="94.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340" y="641.1875"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="269.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340" y="810.8516"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="69.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="345" y="961.6484"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="143.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="335" y="1210.25"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="382.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="335" y="1426.4453"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="247.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340" y="1502.7109"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="79.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="345" y="1544.9766"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="40.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="345" y="1668.375"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="775" y="1880.8438"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="166.2734" style="stroke: #000000; stroke-width: 2.0;" width="370.5" x="245.5" y="584.4453"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="345.2656" style="stroke: #000000; stroke-width: 2.0;" width="503.5" x="235.5" y="764.7188"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="215.0625" style="stroke: #000000; stroke-width: 2.0;" width="483.5" x="245.5" y="830.9844"/><rect fill="#FFFFFF" height="14.8047" style="stroke: none; stroke-width: 1.0;" width="503.5" x="235.5" y="1095.1797"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="339" style="stroke: #000000; stroke-width: 2.0;" width="375.5" x="245.5" y="1441.5781"/><rect fill="#FFFFFF" height="14.8047" style="stroke: none; stroke-width: 1.0;" width="375.5" x="245.5" y="1765.7734"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="171.0313" y2="1928.1094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="339.5" x2="339.5" y1="171.0313" y2="1928.1094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="616" x2="616" y1="171.0313" y2="1928.1094"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="780" x2="780" y1="171.0313" y2="1928.1094"/><rect fill="#FEFECE" filter="url(#fk80a7cw9szhu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="65" y="135.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="72" y="155.7295">chxusecasemc</text><rect fill="#FEFECE" filter="url(#fk80a7cw9szhu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="65" y="1927.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="72" y="1947.1045">chxusecasemc</text><rect fill="#FEFECE" filter="url(#fk80a7cw9szhu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="255.5" y="135.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="262.5" y="155.7295">chxmulticamcontroller</text><rect fill="#FEFECE" filter="url(#fk80a7cw9szhu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="255.5" y="1927.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="151" x="262.5" y="1947.1045">chxmulticamcontroller</text><rect fill="#FEFECE" filter="url(#fk80a7cw9szhu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="543" y="135.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="550" y="155.7295">chxzoomtranslator</text><rect fill="#FEFECE" filter="url(#fk80a7cw9szhu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="543" y="1927.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="550" y="1947.1045">chxzoomtranslator</text><rect fill="#FEFECE" filter="url(#fk80a7cw9szhu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="699" y="135.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="706" y="155.7295">chxextensionmodule</text><rect fill="#FEFECE" filter="url(#fk80a7cw9szhu)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="699" y="1927.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="706" y="1947.1045">chxextensionmodule</text><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="892.8203" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="335" y="245.1641"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="94.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340" y="641.1875"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="269.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340" y="810.8516"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="69.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="345" y="961.6484"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="143.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="335" y="1210.25"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="382.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="335" y="1426.4453"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="247.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340" y="1502.7109"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="79.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="345" y="1544.9766"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="40.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="345" y="1668.375"/><rect fill="#FFFFFF" filter="url(#fk80a7cw9szhu)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="775" y="1880.8438"/><rect fill="#EEEEEE" filter="url(#fk80a7cw9szhu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="879" x="7" y="201.5977"/><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="886" y1="201.5977" y2="201.5977"/><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="886" y1="204.5977" y2="204.5977"/><rect fill="#EEEEEE" filter="url(#fk80a7cw9szhu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="127" x="383" y="191.0313"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="394" y="207.0981">Get Controller</text><polygon fill="#A80036" points="323,241.1641,333,245.1641,323,249.1641,327,245.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126" x2="329" y1="245.1641" y2="245.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="133" y="240.231">GetController</text><rect fill="#FBFB77" filter="url(#fk80a7cw9szhu)" height="314" style="stroke: #A80036; stroke-width: 1.0;" width="657" x="12" y="258.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="16" y="274.3638">we have several controlMode</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="250" x="16" y="291.353">CONTROLLER_TYPE_DUALFOV</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="270" y="291.8247">In usecasemc</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="202" x="16" y="308.814">CONTROLLER_TYPE_RTB</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="222" y="309.2856">In usecasemc</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="277" x="16" y="326.2749">CONTROLLER_TYPE_BAYERMONO</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="193" x="16" y="343.7358">CONTROLLER_TYPE_VR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="359.3403"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="526" x="16" y="374.4731">Now the code changed, and according to the MccCreateData-&gt;logicalCameraType</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="16" y="391.4624">LogicalCameraType_SAT</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="201" x="16" y="408.9233">LogicalCameraType_RTB</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="276" x="16" y="426.3843">LogicalCameraType_BAYERMONO</text><text fill="#000000" font-family="sans-serif" font-size="15" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="192" x="16" y="443.8452">LogicalCameraType_VR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="20" y="459.4497"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="16" y="474.5825">有个问题：为什么有了MultiFov还保留着DualFov？</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="16" y="489.7153">其他：</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="32" y="504.8481">1. 什么是pixel size？</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="366" x="48" y="519.981">就是sensor pixel的大小。也常被描述为pixel Pitch. 就是pixel与pixel之间的间隔</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="32" y="535.1138">2. 如何维持同样的进光量？ 暂时存疑！！！ TODO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="617" x="48" y="550.2466">假设一个50mm focallength， f/1.4光圈。 如果现在perture diameter(35.7mm)【光圈直径】， focal length是8.3mm。</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="48" y="565.3794">同样的进光量, lens是f/0.23 (8.3/35.7)</text><rect fill="none" height="166.2734" style="stroke: #000000; stroke-width: 2.0;" width="370.5" x="245.5" y="584.4453"/><polygon fill="#EEEEEE" points="245.5,584.4453,309.5,584.4453,309.5,591.4453,299.5,601.4453,245.5,601.4453,245.5,584.4453" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="260.5" y="597.5122">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="324.5" y="596.6558">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="243" x="329.5" y="596.6558">pMccCreateData-&gt;logicalCameraType</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="576.5" y="596.6558">==</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="328.5" y="609.4604"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="258" x="328.5" y="609.4604">pMultiCamController-&gt;GetCameraType()</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="586.5" y="609.4604">]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="345" x2="392" y1="628.3203" y2="628.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="392" x2="392" y1="628.3203" y2="641.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="351" x2="392" y1="641.3203" y2="641.3203"/><polygon fill="#A80036" points="361,637.3203,351,641.3203,361,645.3203,357,641.3203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="357" y="623.2544">pMultiCamController-&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="503" y="623.2544">Reconfigure()</text><polygon fill="#FBFB77" filter="url(#fk80a7cw9szhu)" points="355,659.3203,355,699.3203,555,699.3203,555,669.3203,545,659.3203,355,659.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="545" x2="545" y1="659.3203" y2="669.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="555" x2="545" y1="669.3203" y2="669.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="361" y="676.3872">If already Created Controller</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="361" y="691.52">will ReConfig</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="392" y1="734.7188" y2="734.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="392" x2="392" y1="734.7188" y2="747.7188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="345" x2="392" y1="747.7188" y2="747.7188"/><polygon fill="#A80036" points="355,743.7188,345,747.7188,355,751.7188,351,747.7188" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="357" y="729.6528">return</text><rect fill="none" height="345.2656" style="stroke: #000000; stroke-width: 2.0;" width="503.5" x="235.5" y="764.7188"/><polygon fill="#EEEEEE" points="235.5,764.7188,299.5,764.7188,299.5,771.7188,289.5,781.7188,235.5,781.7188,235.5,764.7188" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="250.5" y="777.7856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="314.5" y="776.9292">[LogicalCameraType_SAT]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="345" x2="392" y1="797.9844" y2="797.9844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="392" x2="392" y1="797.9844" y2="810.9844"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="351" x2="392" y1="810.9844" y2="810.9844"/><polygon fill="#A80036" points="361,806.9844,351,810.9844,361,814.9844,357,810.9844" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="193" x="357" y="792.9185">MultiFovController::Create</text><rect fill="none" height="215.0625" style="stroke: #000000; stroke-width: 2.0;" width="483.5" x="245.5" y="830.9844"/><polygon fill="#EEEEEE" points="245.5,830.9844,322.5,830.9844,322.5,837.9844,312.5,847.9844,245.5,847.9844,245.5,830.9844" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="260.5" y="844.0513">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="337.5" y="843.1948">[numOfLinkedSessions]</text><polygon fill="#FBFB77" filter="url(#fk80a7cw9szhu)" points="355,853.1172,355,923.1172,715,923.1172,715,863.1172,705,853.1172,355,853.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="853.1172" y2="863.1172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="715" x2="705" y1="863.1172" y2="863.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="339" x="361" y="870.1841">[tips: numOflinkedSessions==numBundledCameras]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="361" y="885.3169">Get Focal Length</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="361" y="900.4497">Get Max Zoom</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="361" y="915.5825">Update OTP Data</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="397" y1="948.7813" y2="948.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397" x2="397" y1="948.7813" y2="961.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="356" x2="397" y1="961.7813" y2="961.7813"/><polygon fill="#A80036" points="366,957.7813,356,961.7813,366,965.7813,362,961.7813" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="362" y="943.7153">InitZoomTranslator()</text><polygon fill="#A80036" points="604,991.7813,614,995.7813,604,999.7813,608,995.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="610" y1="995.7813" y2="995.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="186" x="362" y="990.8481">m_pZoomTranslator-&gt;Init</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="397" y1="1030.0469" y2="1030.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397" x2="397" y1="1030.0469" y2="1043.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="397" y1="1043.0469" y2="1043.0469"/><polygon fill="#A80036" points="360,1039.0469,350,1043.0469,360,1047.0469,356,1043.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="362" y="1024.981">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="392" y1="1079.1797" y2="1079.1797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="392" x2="392" y1="1079.1797" y2="1092.1797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="345" x2="392" y1="1092.1797" y2="1092.1797"/><polygon fill="#A80036" points="355,1088.1797,345,1092.1797,355,1096.1797,351,1092.1797" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="357" y="1074.1138">return</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="235.5" x2="739" y1="1096.1797" y2="1096.1797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="167" x="240.5" y="1106.3901">[LogicalCameraType_RTB]</text><polygon fill="#A80036" points="137,1133.9844,127,1137.9844,137,1141.9844,133,1137.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131" x2="339" y1="1137.9844" y2="1137.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="143" y="1133.0513">return</text><rect fill="#EEEEEE" filter="url(#fk80a7cw9szhu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="879" x="7" y="1166.6836"/><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="886" y1="1166.6836" y2="1166.6836"/><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="886" y1="1169.6836" y2="1169.6836"/><rect fill="#EEEEEE" filter="url(#fk80a7cw9szhu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="224" x="334.5" y="1156.1172"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="200" x="345.5" y="1172.1841">Translate Request Settings</text><polygon fill="#A80036" points="323,1206.25,333,1210.25,323,1214.25,327,1210.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="126" x2="329" y1="1210.25" y2="1210.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="190" x="133" y="1205.3169">TranslateRequestSettings</text><polygon fill="#FBFB77" filter="url(#fk80a7cw9szhu)" points="350,1223.3828,350,1323.3828,877,1323.3828,877,1233.3828,867,1223.3828,350,1223.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="867" x2="867" y1="1223.3828" y2="1233.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="877" x2="867" y1="1233.3828" y2="1233.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="506" x="356" y="1240.4497">For Main and Aux, for same CropRegion/zoom Param, they have different result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="356" y="1255.5825">also</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="356" y="1270.7153">the AF ROI need translate(</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="185" x="524" y="1270.7153">TranslateMeteringRegion</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="9" x="709" y="1270.7153">).</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="356" y="1285.8481">the fov_ratio=main_fov/aux_fov</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="356" y="1300.981">首先根据sensor size等比例放大或缩小AFRegion</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="415" x="356" y="1316.1138">然后根据fov_ration计算具体的xMin/yMin/xMax/yMax；这些region会在AF中fetch到</text><polygon fill="#A80036" points="137,1350.1797,127,1354.1797,137,1358.1797,133,1354.1797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131" x2="339" y1="1354.1797" y2="1354.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="143" y="1349.2466">return</text><rect fill="#EEEEEE" filter="url(#fk80a7cw9szhu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="879" x="7" y="1382.8789"/><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="886" y1="1382.8789" y2="1382.8789"/><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="886" y1="1385.8789" y2="1385.8789"/><rect fill="#EEEEEE" filter="url(#fk80a7cw9szhu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="196" x="348.5" y="1372.3125"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="359.5" y="1388.3794">ConsolidateCameraInfo</text><polygon fill="#A80036" points="356,1422.4453,346,1426.4453,356,1430.4453,352,1426.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="779" y1="1426.4453" y2="1426.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="362" y="1421.5122">ConsolidateCameraInfo</text><rect fill="none" height="339" style="stroke: #000000; stroke-width: 2.0;" width="375.5" x="245.5" y="1441.5781"/><polygon fill="#EEEEEE" points="245.5,1441.5781,309.5,1441.5781,309.5,1448.5781,299.5,1458.5781,245.5,1458.5781,245.5,1441.5781" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="260.5" y="1454.645">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="324.5" y="1453.7886">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="156" x="329.5" y="1453.7886">LogicalCameraType_SAT</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="485.5" y="1453.7886">]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="345" x2="392" y1="1489.9766" y2="1489.9766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="392" x2="392" y1="1489.9766" y2="1502.9766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="351" x2="392" y1="1502.9766" y2="1502.9766"/><polygon fill="#A80036" points="361,1498.9766,351,1502.9766,361,1506.9766,357,1502.9766" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="357" y="1469.7778">MultiFovController::</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="357" y="1484.9106">ConsolidateCameraInfo</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="397" y1="1532.1094" y2="1532.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397" x2="397" y1="1532.1094" y2="1545.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="356" x2="397" y1="1545.1094" y2="1545.1094"/><polygon fill="#A80036" points="366,1541.1094,356,1545.1094,366,1549.1094,362,1545.1094" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="200" x="362" y="1527.0435">ConsolidateStreamConfig()</text><polygon fill="#FBFB77" filter="url(#fk80a7cw9szhu)" points="360,1563.1094,360,1588.1094,535,1588.1094,535,1573.1094,525,1563.1094,360,1563.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="525" x2="525" y1="1563.1094" y2="1573.1094"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="535" x2="525" y1="1573.1094" y2="1573.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="366" y="1580.1763">mainly Update the Meta</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="397" y1="1623.375" y2="1623.375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397" x2="397" y1="1623.375" y2="1636.375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="397" y1="1636.375" y2="1636.375"/><polygon fill="#A80036" points="360,1632.375,350,1636.375,360,1640.375,356,1636.375" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="362" y="1618.3091">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="397" y1="1655.5078" y2="1655.5078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397" x2="397" y1="1655.5078" y2="1668.5078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="356" x2="397" y1="1668.5078" y2="1668.5078"/><polygon fill="#A80036" points="366,1664.5078,356,1668.5078,366,1672.5078,362,1668.5078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="247" x="362" y="1650.4419">ConsolidateMinFpsStallDuration()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="397" y1="1707.6406" y2="1707.6406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397" x2="397" y1="1707.6406" y2="1720.6406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="397" y1="1720.6406" y2="1720.6406"/><polygon fill="#A80036" points="360,1716.6406,350,1720.6406,360,1724.6406,356,1720.6406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="362" y="1702.5747">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="392" y1="1749.7734" y2="1749.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="392" x2="392" y1="1749.7734" y2="1762.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="345" x2="392" y1="1762.7734" y2="1762.7734"/><polygon fill="#A80036" points="355,1758.7734,345,1762.7734,355,1766.7734,351,1762.7734" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="357" y="1744.7075">return</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="245.5" x2="621" y1="1766.7734" y2="1766.7734"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="250.5" y="1776.9839">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="255.5" y="1776.9839">LogicalCameraType_RTB</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="412.5" y="1776.9839">]</text><polygon fill="#A80036" points="768,1804.5781,778,1808.5781,768,1812.5781,772,1808.5781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="340" x2="774" y1="1808.5781" y2="1808.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="347" y="1803.645">return</text><rect fill="#EEEEEE" filter="url(#fk80a7cw9szhu)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="879" x="7" y="1837.2773"/><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="886" y1="1837.2773" y2="1837.2773"/><line style="stroke: #000000; stroke-width: 1.0;" x1="7" x2="886" y1="1840.2773" y2="1840.2773"/><rect fill="#EEEEEE" filter="url(#fk80a7cw9szhu)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="269" x="312" y="1826.7109"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="245" x="323" y="1842.7778">how we expose CameraID to app</text><ellipse cx="14.5" cy="1880.0938" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#A80036" points="763,1876.8438,773,1880.8438,763,1884.8438,767,1880.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="19" x2="769" y1="1880.8438" y2="1880.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="186" x="22" y="1875.9106">BuildLogicalCameraInfo()</text><polygon fill="#A80036" points="26,1905.9766,16,1909.9766,26,1913.9766,22,1909.9766" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="779.5" cy="1909.2266" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="20" x2="775" y1="1909.9766" y2="1909.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="32" y="1905.0435">return</text><!--
@startuml

title 
<size:18>camx multicam controller</size>\n     Lin Jin
1. ENABLE_SNAPSHOT_FUSION: if we capture snapshot from both camera and feeding to fusion algo
2. ENABLE_LPM: where only one camera
3. SYNC_MECHANSIM: HW_SYNC, SW_SYNC(not supported)
4. SNAPSHOT_FUSION_ZOOM_MIN/MAX
5. SNAPSHOT_FUSION_LUX_IDX_THRESHOLD(1.0)
6. SNAPSHOT_FUSION_FOCUS_DIST_CM_MIN(15) if focus dist lower then thres, snapshot fusion will be disabled
end title

participant chxusecasemc
participant chxmulticamcontroller
participant chxzoomtranslator
participant chxextensionmodule

== <color:blue> Get Controller </color>==
chxusecasemc->chxmulticamcontroller: GetController
activate chxmulticamcontroller
  rnote over chxmulticamcontroller
    we have several controlMode
    <size:15>**CONTROLLER_TYPE_DUALFOV**</size> In usecasemc
    <size:15>**CONTROLLER_TYPE_RTB**</size> In usecasemc
    <size:15>**CONTROLLER_TYPE_BAYERMONO**</size>
    <size:15>**CONTROLLER_TYPE_VR**</size>
    
    Now the code changed, and according to the MccCreateData->logicalCameraType
    <size:15>**LogicalCameraType_SAT**</size>
    <size:15>**LogicalCameraType_RTB**</size>
    <size:15>**LogicalCameraType_BAYERMONO**</size>
    <size:15>**LogicalCameraType_VR**</size>

    有个问题：为什么有了MultiFov还保留着DualFov？
    其他：
        1. 什么是pixel size？
            就是sensor pixel的大小。也常被描述为pixel Pitch. 就是pixel与pixel之间的间隔
        2. 如何维持同样的进光量？ 暂时存疑！！！ TODO
            假设一个50mm focallength， f/1.4光圈。 如果现在perture diameter(35.7mm)【光圈直径】， focal length是8.3mm。
            同样的进光量, lens是f/0.23 (8.3/35.7)
  end rnote

  alt **pMccCreateData->logicalCameraType** == \n **pMultiCamController->GetCameraType()**
    chxmulticamcontroller->chxmulticamcontroller: pMultiCamController->**Reconfigure()**
    activate chxmulticamcontroller
      note right chxmulticamcontroller
        If already Created Controller
        will ReConfig
      end note

    chxmulticamcontroller->chxmulticamcontroller: return
    deactivate chxmulticamcontroller
  end

  alt LogicalCameraType_SAT
    chxmulticamcontroller->chxmulticamcontroller: **MultiFovController::Create**
    activate chxmulticamcontroller
      loop numOfLinkedSessions  
        note right chxmulticamcontroller
          [tips: numOflinkedSessions==numBundledCameras]
          Get Focal Length
          Get Max Zoom
          Update OTP Data
        end note

        chxmulticamcontroller->chxmulticamcontroller: **InitZoomTranslator()**
        activate chxmulticamcontroller
          chxmulticamcontroller->chxzoomtranslator: **m_pZoomTranslator->Init**
        chxmulticamcontroller->chxmulticamcontroller: return
        deactivate chxmulticamcontroller
      end loop
    chxmulticamcontroller->chxmulticamcontroller: return
    deactivate chxmulticamcontroller
  else LogicalCameraType_RTB
  end
chxmulticamcontroller->chxusecasemc: return
deactivate chxmulticamcontroller

== <color:blue> Translate Request Settings </color>==
chxusecasemc->chxmulticamcontroller: **TranslateRequestSettings**
activate chxmulticamcontroller
  note right chxmulticamcontroller
    For Main and Aux, for same CropRegion/zoom Param, they have different result
    also
    the AF ROI need translate(**TranslateMeteringRegion**). 
    the fov_ratio=main_fov/aux_fov
    首先根据sensor size等比例放大或缩小AFRegion
    然后根据fov_ration计算具体的xMin/yMin/xMax/yMax；这些region会在AF中fetch到
  end note
chxmulticamcontroller->chxusecasemc: return
deactivate chxmulticamcontroller

==<color:blue> ConsolidateCameraInfo </color>==
chxextensionmodule->chxmulticamcontroller: ConsolidateCameraInfo
activate chxmulticamcontroller
  alt **LogicalCameraType_SAT**
    chxmulticamcontroller->chxmulticamcontroller: MultiFovController::\n**ConsolidateCameraInfo**
    activate chxmulticamcontroller

      chxmulticamcontroller->chxmulticamcontroller: **ConsolidateStreamConfig()**
      activate chxmulticamcontroller
        note right chxmulticamcontroller
            mainly Update the Meta
        end note
      chxmulticamcontroller->chxmulticamcontroller: return
      deactivate chxmulticamcontroller

      chxmulticamcontroller->chxmulticamcontroller: **ConsolidateMinFpsStallDuration()**
      activate chxmulticamcontroller
      chxmulticamcontroller->chxmulticamcontroller: return
      deactivate chxmulticamcontroller

    chxmulticamcontroller->chxmulticamcontroller: return
    deactivate chxmulticamcontroller
  else **LogicalCameraType_RTB**
  end

chxextensionmodule<-chxmulticamcontroller: return
deactivate chxmulticamcontroller

==<color:blue> how we expose CameraID to app </color>==
[o->chxextensionmodule: **BuildLogicalCameraInfo()**
activate chxextensionmodule
[o<-chxextensionmodule: return
deactivate chxextensionmodule
@enduml

PlantUML version 1.2017.20(Mon Dec 11 16:57:05 GMT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_171-8u171-b11-0ubuntu0.16.04.1-b11
Operating System: Linux
OS Version: 4.4.0-43-Microsoft
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>