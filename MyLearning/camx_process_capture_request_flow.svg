<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1020px" preserveAspectRatio="none" style="width:2235px;height:1020px;" version="1.1" viewBox="0 0 2235 1020" width="2235px" zoomAndPan="magnify"><defs><filter height="300%" id="f1pih4vx57po37" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="215" x="1015.25" y="24.5332">process_capture_request flow</text><rect fill="#FFFFFF" filter="url(#f1pih4vx57po37)" height="156.7578" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="970" y="311.3281"/><rect fill="#FFFFFF" filter="url(#f1pih4vx57po37)" height="438.4063" style="stroke: #000000; stroke-width: 2.0;" width="1328.5" x="895.5" y="523.7891"/><rect fill="#FFFFFF" filter="url(#f1pih4vx57po37)" height="330.3516" style="stroke: #000000; stroke-width: 2.0;" width="1308.5" x="905.5" y="549.1406"/><rect fill="#FFFFFF" height="46.1875" style="stroke: none; stroke-width: 1.0;" width="1308.5" x="905.5" y="833.3047"/><rect fill="#FFFFFF" filter="url(#f1pih4vx57po37)" height="61.7031" style="stroke: #000000; stroke-width: 2.0;" width="235.5" x="905.5" y="893.4922"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="271" x2="271" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="435.5" x2="435.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="630.5" x2="630.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="818.5" x2="818.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="974.5" x2="974.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1156.5" x2="1156.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1319.5" x2="1319.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1478.5" x2="1478.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1627.5" x2="1627.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1754.5" x2="1754.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1874.5" x2="1874.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2034.5" x2="2034.5" y1="71.2188" y2="979.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2176.5" x2="2176.5" y1="71.2188" y2="979.1953"/><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="219" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="226" y="56.1426">camxhal3.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="219" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="226" y="999.7285">camxhal3.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="367.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="374.5" y="56.1426">camxhaldevice.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="367.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="374.5" y="999.7285">camxhaldevice.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="177" x="540.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="163" x="547.5" y="56.1426">chxextensioninterface.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="177" x="540.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="163" x="547.5" y="999.7285">chxextensioninterface.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="731.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="738.5" y="56.1426">chxentensionmodule.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="731.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="738.5" y="999.7285">chxentensionmodule.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="915.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="922.5" y="56.1426">chxusecase.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="915.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="922.5" y="999.7285">chxusecase.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1085.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="1092.5" y="56.1426">camera_metadata.c</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="1085.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="1092.5" y="999.7285">camera_metadata.c</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="1238.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="1245.5" y="56.1426">chxusecasedefault.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="1238.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="1245.5" y="999.7285">chxusecasedefault.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="1410.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1417.5" y="56.1426">chxusecasemc.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="1410.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="1417.5" y="999.7285">chxusecasemc.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="1557.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="1564.5" y="56.1426">camxchicontext.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="1557.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="122" x="1564.5" y="999.7285">camxchicontext.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="91" x="1707.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="1714.5" y="56.1426">camxchi.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="91" x="1707.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="1714.5" y="999.7285">camxchi.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="1812.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="1819.5" y="56.1426">camxsession.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="1812.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="1819.5" y="999.7285">camxsession.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="1947.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="1954.5" y="56.1426">camxthreadmanager.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="170" x="1947.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="156" x="1954.5" y="999.7285">camxthreadmanager.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="2131.5" y="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="2138.5" y="56.1426">chxutils.cpp</text><rect fill="#FEFECE" filter="url(#f1pih4vx57po37)" height="31.6094" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="2131.5" y="978.1953"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="2138.5" y="999.7285">chxutils.cpp</text><rect fill="#FFFFFF" filter="url(#f1pih4vx57po37)" height="156.7578" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="970" y="311.3281"/><polygon fill="#FBFB77" filter="url(#f1pih4vx57po37)" points="8,86.2188,8,112.2188,262,112.2188,262,96.2188,252,86.2188,8,86.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="252" y1="86.2188" y2="96.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="262" x2="252" y1="96.2188" y2="96.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="14" y="104.7139">framework call process_capture_request</text><polygon fill="#A80036" points="424,139.5703,434,143.5703,424,147.5703,428,143.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="271" x2="430" y1="143.5703" y2="143.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="278" y="139.0654">ProcessCaptureRequest</text><polygon fill="#A80036" points="619,169.9219,629,173.9219,619,177.9219,623,173.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="436" x2="625" y1="173.9219" y2="173.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="443" y="169.417">chi_override_process_request</text><polygon fill="#A80036" points="806.5,200.2734,816.5,204.2734,806.5,208.2734,810.5,204.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="631" x2="812.5" y1="204.2734" y2="204.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="638" y="199.7686">OverrideProcessRequest</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="975" x2="1017" y1="260.3281" y2="260.3281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1017" x2="1017" y1="260.3281" y2="273.3281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="976" x2="1017" y1="273.3281" y2="273.3281"/><polygon fill="#A80036" points="986,269.3281,976,273.3281,986,277.3281,982,273.3281" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="982" y="255.4717">GetChiOverrideFrameNum</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="975" x2="1022" y1="298.6797" y2="298.6797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1022" x2="1022" y1="298.6797" y2="311.6797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="981" x2="1022" y1="311.6797" y2="311.6797"/><polygon fill="#A80036" points="991,307.6797,981,311.6797,991,315.6797,987,311.6797" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="987" y="293.8232">ReplaceRequestMetadata</text><polygon fill="#A80036" points="1145,342.6797,1155,346.6797,1145,350.6797,1149,346.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980" x2="1151" y1="346.6797" y2="346.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="987" y="342.1748">place_camera_metadata</text><polygon fill="#A80036" points="1145,373.0313,1155,377.0313,1145,381.0313,1149,377.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980" x2="1151" y1="377.0313" y2="377.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="987" y="372.5264">append_camera_metadata</text><polygon fill="#A80036" points="1145,403.3828,1155,407.3828,1145,411.3828,1149,407.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980" x2="1151" y1="407.3828" y2="407.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="987" y="402.8779">find_camera_metadata</text><polygon fill="#A80036" points="2165,433.7344,2175,437.7344,2165,441.7344,2169,437.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980" x2="2171" y1="437.7344" y2="437.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="115" x="987" y="433.2295">SetVendorTagValue</text><polygon fill="#A80036" points="986,464.0859,976,468.0859,986,472.0859,982,468.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980" x2="2176" y1="468.0859" y2="468.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="992" y="463.5811">return</text><polygon fill="#FBFB77" filter="url(#f1pih4vx57po37)" points="1162,481.4375,1162,507.4375,1384,507.4375,1384,491.4375,1374,481.4375,1162,481.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1374" x2="1374" y1="481.4375" y2="491.4375"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1384" x2="1374" y1="491.4375" y2="491.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="1168" y="499.9326">why we need to replace meta first?</text><rect fill="none" height="438.4063" style="stroke: #000000; stroke-width: 2.0;" width="1328.5" x="895.5" y="523.7891"/><polygon fill="#EEEEEE" points="895.5,523.7891,960.5,523.7891,960.5,531.7891,950.5,541.7891,895.5,541.7891,895.5,523.7891" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20" x="910.5" y="538.2842">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="141" x="975.5" y="537.208">[ExecuteCaptureRequest]</text><rect fill="none" height="330.3516" style="stroke: #000000; stroke-width: 2.0;" width="1308.5" x="905.5" y="549.1406"/><polygon fill="#EEEEEE" points="905.5,549.1406,966.5,549.1406,966.5,557.1406,956.5,567.1406,905.5,567.1406,905.5,549.1406" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="920.5" y="563.6357">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="981.5" y="562.5596">[single camera case]</text><polygon fill="#A80036" points="1307.5,585.4922,1317.5,589.4922,1307.5,593.4922,1311.5,589.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="975" x2="1313.5" y1="589.4922" y2="589.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="982" y="584.9873">ExecuteCaptureRequest</text><polygon fill="#A80036" points="986,615.8438,976,619.8438,986,623.8438,982,619.8438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980" x2="1318.5" y1="619.8438" y2="619.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="992" y="615.3389">UpdateSensorModeIndex</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1319.5" x2="1361.5" y1="650.5469" y2="650.5469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1361.5" y1="650.5469" y2="663.5469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1320.5" x2="1361.5" y1="663.5469" y2="663.5469"/><polygon fill="#A80036" points="1330.5,659.5469,1320.5,663.5469,1330.5,667.5469,1326.5,663.5469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="1326.5" y="645.6904">SubmitChiRequest</text><polygon fill="#A80036" points="1743,689.5469,1753,693.5469,1743,697.5469,1747,693.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1319.5" x2="1749" y1="693.5469" y2="693.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="1326.5" y="689.042">ChiSubmitPipelineRequest</text><polygon fill="#A80036" points="1638.5,719.8984,1628.5,723.8984,1638.5,727.8984,1634.5,723.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1632.5" x2="1754" y1="723.8984" y2="723.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="1644.5" y="719.3936">SubmitRequest</text><polygon fill="#A80036" points="1863,750.25,1873,754.25,1863,758.25,1867,754.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1627.5" x2="1869" y1="754.25" y2="754.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="1634.5" y="749.7451">ProcessCaptureRequest</text><polygon fill="#A80036" points="2022.5,780.6016,2032.5,784.6016,2022.5,788.6016,2026.5,784.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1875" x2="2028.5" y1="784.6016" y2="784.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="1882" y="780.0967">PostJob</text><polygon fill="#FBFB77" filter="url(#f1pih4vx57po37)" points="2039,797.9531,2039,823.9531,2200,823.9531,2200,807.9531,2190,797.9531,2039,797.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2190" x2="2190" y1="797.9531" y2="807.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2200" x2="2190" y1="807.9531" y2="807.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="2045" y="816.4482">post a job to thread pool</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="905.5" x2="2214" y1="834.3047" y2="834.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="109" x="910.5" y="845.7236">[multi camera case]</text><polygon fill="#A80036" points="1467,867.1406,1477,871.1406,1467,875.1406,1471,871.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="975" x2="1473" y1="871.1406" y2="871.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="982" y="866.6357">ExecuteCaptureRequest2</text><rect fill="none" height="61.7031" style="stroke: #000000; stroke-width: 2.0;" width="235.5" x="905.5" y="893.4922"/><polygon fill="#EEEEEE" points="905.5,893.4922,970.5,893.4922,970.5,901.4922,960.5,911.4922,905.5,911.4922,905.5,893.4922" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="20" x="920.5" y="907.9873">opt</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="975" x2="1017" y1="934.1953" y2="934.1953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1017" x2="1017" y1="934.1953" y2="947.1953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="976" x2="1017" y1="947.1953" y2="947.1953"/><polygon fill="#A80036" points="986,943.1953,976,947.1953,986,951.1953,982,947.1953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="982" y="929.3389">RestoreRequestMetadata</text><!--
@startuml
title process_capture_request flow


participant camxhal3.cpp as camxhal3
participant camxhaldevice.cpp as camxhaldev
participant chxextensioninterface.cpp as chieintf
participant chxentensionmodule.cpp as chiemodule
participant chxusecase.cpp as chxusecase
participant camera_metadata.c as cmeta
participant chxusecasedefault.cpp as chxdef
participant chxusecasemc.cpp as chxmc
participant camxchicontext.cpp as chicontext
participant camxchi.cpp as camxchi
participant camxsession.cpp as camxsession
participant camxthreadmanager.cpp as camxthreadM

note left of camxhal3: framework call process_capture_request

camxhal3->camxhaldev:ProcessCaptureRequest
camxhaldev->chieintf: chi_override_process_request
chieintf->chiemodule:OverrideProcessRequest

opt usecase processcaptureRequest
chxusecase->chxusecase: GetChiOverrideFrameNum

chxusecase->chxusecase: ReplaceRequestMetadata
activate chxusecase
chxusecase->cmeta: place_camera_metadata
chxusecase->cmeta: append_camera_metadata
chxusecase->cmeta: find_camera_metadata
chxusecase->chxutils.cpp: SetVendorTagValue
chxutils.cpp->chxusecase: return
deactivate chxusecase

note right of cmeta: why we need to replace meta first?

opt ExecuteCaptureRequest
alt single camera case
chxusecase->chxdef: ExecuteCaptureRequest
chxdef->chxusecase: UpdateSensorModeIndex
chxdef->chxdef: SubmitChiRequest
chxdef->camxchi: ChiSubmitPipelineRequest
camxchi->chicontext: SubmitRequest
chicontext->camxsession: ProcessCaptureRequest
camxsession->camxthreadM: PostJob
note right of camxthreadM: post a job to thread pool

else multi camera case

chxusecase->chxmc: ExecuteCaptureRequest2

end

opt
chxusecase->chxusecase: RestoreRequestMetadata
end

end

@end

PlantUML version 1.2017.20(Mon Dec 11 08:57:05 PST 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Java Version: 1.8.0_161-b12
Operating System: Windows 10
OS Version: 10.0
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>