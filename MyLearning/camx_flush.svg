<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1071px" preserveAspectRatio="none" style="width:1291px;height:1071px;" version="1.1" viewBox="0 0 1291 1071" width="1291px" zoomAndPan="magnify"><defs><filter height="300%" id="f1biwn2u6uayja" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1056.3203" style="stroke: #A80036; stroke-width: 1.0;" width="109" x="677" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="61" x="701" y="16.0669">Usecase</text><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="388.9922" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="248" y="614.8984"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="330.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="409" y="644.0313"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="272.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="673.1641"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="726.5" y="780.6953"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="246.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="841" y="216.5"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="139.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="846" y="279.7656"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="203.0625" style="stroke: #000000; stroke-width: 2.0;" width="487" x="782" y="231.6328"/><rect fill="#FFFFFF" height="185.9297" style="stroke: none; stroke-width: 1.0;" width="487" x="782" y="248.7656"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="175.0625" style="stroke: #000000; stroke-width: 2.0;" width="603" x="499" y="742.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252.5" x2="252.5" y1="58.4297" y2="154.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="252.5" x2="252.5" y1="154.6953" y2="195.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252.5" x2="252.5" y1="195.5" y2="470.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="252.5" x2="252.5" y1="470.8281" y2="511.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252.5" x2="252.5" y1="511.6328" y2="1022.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="414" x2="414" y1="58.4297" y2="154.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="414" x2="414" y1="154.6953" y2="195.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="414" x2="414" y1="195.5" y2="470.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="414" x2="414" y1="470.8281" y2="511.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="414" x2="414" y1="511.6328" y2="1022.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="590" x2="590" y1="58.4297" y2="154.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="590" x2="590" y1="154.6953" y2="195.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="590" x2="590" y1="195.5" y2="470.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="590" x2="590" y1="470.8281" y2="511.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="590" x2="590" y1="511.6328" y2="1022.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="731" x2="731" y1="58.4297" y2="154.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="731" x2="731" y1="154.6953" y2="195.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="731" x2="731" y1="195.5" y2="470.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="731" x2="731" y1="470.8281" y2="511.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="731" x2="731" y1="511.6328" y2="1022.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="846" x2="846" y1="58.4297" y2="154.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="846" x2="846" y1="154.6953" y2="195.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="846" x2="846" y1="195.5" y2="470.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="846" x2="846" y1="470.8281" y2="511.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="846" x2="846" y1="511.6328" y2="1022.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="981" x2="981" y1="58.4297" y2="154.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="981" x2="981" y1="154.6953" y2="195.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="981" x2="981" y1="195.5" y2="470.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="981" x2="981" y1="470.8281" y2="511.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="981" x2="981" y1="511.6328" y2="1022.0234"/><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="193.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="200.5" y="43.1279">camxhaldevice</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="193.5" y="1021.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="200.5" y="1041.0186">camxhaldevice</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="329" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="336" y="43.1279">chxextensioninterface</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="329" y="1021.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="336" y="1041.0186">chxextensioninterface</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="509" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="516" y="43.1279">chxextensionmodule</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="509" y="1021.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="516" y="1041.0186">chxextensionmodule</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="681" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="688" y="43.1279">chxusecase</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="681" y="1021.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="688" y="1041.0186">chxusecase</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="792" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="799" y="43.1279">camxsession</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="792" y="1021.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="799" y="1041.0186">camxsession</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="24" x="967" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="10" x="974" y="43.1279">B</text><rect fill="#FEFECE" filter="url(#f1biwn2u6uayja)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="24" x="967" y="1021.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="10" x="974" y="1041.0186">B</text><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="388.9922" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="248" y="614.8984"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="330.7266" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="409" y="644.0313"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="272.4609" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="585" y="673.1641"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="128.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="726.5" y="780.6953"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="246.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="841" y="216.5"/><rect fill="#FFFFFF" filter="url(#f1biwn2u6uayja)" height="139.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="846" y="279.7656"/><rect fill="#EEEEEE" filter="url(#f1biwn2u6uayja)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1276" x="3" y="88.9961"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1279" y1="88.9961" y2="88.9961"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1279" y1="91.9961" y2="91.9961"/><rect fill="#EEEEEE" filter="url(#f1biwn2u6uayja)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="316" x="483" y="78.4297"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="292" x="494" y="94.4966">How the camx keep request in a queue</text><rect fill="#EEEEEE" filter="url(#f1biwn2u6uayja)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1276" x="3" y="132.1289"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1279" y1="132.1289" y2="132.1289"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1279" y1="135.1289" y2="135.1289"/><rect fill="#EEEEEE" filter="url(#f1biwn2u6uayja)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="315" x="483.5" y="121.5625"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="494.5" y="137.6294"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="291" x="494.5" y="137.6294">What will happen when app call a flush</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="790.5" y="137.6294"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="619" y="178.9058"/><ellipse cx="10.5" cy="215.75" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#A80036" points="829,212.5,839,216.5,829,220.5,833,216.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="15" x2="835" y1="216.5" y2="216.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="18" y="211.5669">Flush()</text><rect fill="none" height="203.0625" style="stroke: #000000; stroke-width: 2.0;" width="487" x="782" y="231.6328"/><polygon fill="#EEEEEE" points="782,231.6328,846,231.6328,846,238.6328,836,248.6328,782,248.6328,782,231.6328" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="797" y="244.6997">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="861" y="243.8433">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="213" x="866" y="243.8433">m_sessionInitComplete == FALSE</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="1079" y="243.8433">]</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="782" x2="1269" y1="249.7656" y2="249.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="851" x2="898" y1="266.8984" y2="266.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="898" x2="898" y1="266.8984" y2="279.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="857" x2="898" y1="279.8984" y2="279.8984"/><polygon fill="#A80036" points="867,275.8984,857,279.8984,867,283.8984,863,279.8984" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="863" y="261.8325">FlushHALQueue()</text><polygon fill="#FBFB77" filter="url(#f1biwn2u6uayja)" points="861,297.8984,861,382.8984,1255,382.8984,1255,307.8984,1245,297.8984,861,297.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1245" x2="1245" y1="297.8984" y2="307.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1255" x2="1245" y1="307.8984" y2="307.8984"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="867" y="314.9653">m_pRequestQueue-&gt;Dequeue</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1067" y="314.9653">all the request, and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="867" y="330.0981">run</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="250" x="892" y="330.0981">PrepareAndDispatchRequestError</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="1142" y="330.0981">, which</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="373" x="867" y="345.231">will return MessageTypeError and then release the request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="867" y="360.3638">the</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="192" x="892" y="360.3638">HAL3Queue::EnqueueWait</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1084" y="360.3638">, will wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="867" y="375.4966">release and can enqueue a new request</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="856" x2="898" y1="418.6953" y2="418.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="898" x2="898" y1="418.6953" y2="431.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="851" x2="898" y1="431.6953" y2="431.6953"/><polygon fill="#A80036" points="861,427.6953,851,431.6953,861,435.6953,857,431.6953" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="863" y="413.6294">return</text><polygon fill="#A80036" points="22,458.6953,12,462.6953,22,466.6953,18,462.6953" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="845.5" cy="461.9453" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="16" x2="841" y1="462.6953" y2="462.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="28" y="457.7622">return</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="619" y="495.0386"/><rect fill="#EEEEEE" filter="url(#f1biwn2u6uayja)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1276" x="3" y="532.1992"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1279" y1="532.1992" y2="532.1992"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1279" y1="535.1992" y2="535.1992"/><rect fill="#EEEEEE" filter="url(#f1biwn2u6uayja)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="187" x="547.5" y="521.6328"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="558.5" y="537.6997"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="163" x="558.5" y="537.6997">Flush called from APP</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="726.5" y="537.6997"/><polygon fill="#FBFB77" filter="url(#f1biwn2u6uayja)" points="8,559.7656,8,584.7656,244,584.7656,244,569.7656,234,559.7656,8,559.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="234" x2="234" y1="559.7656" y2="569.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="244" x2="234" y1="569.7656" y2="569.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="14" y="576.8325">App call flush and will go into here</text><ellipse cx="10.5" cy="614.1484" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><polygon fill="#A80036" points="236,610.8984,246,614.8984,236,618.8984,240,614.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="15" x2="242" y1="614.8984" y2="614.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="18" y="609.9653">Flush()</text><polygon fill="#A80036" points="397,640.0313,407,644.0313,397,648.0313,401,644.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="258" x2="403" y1="644.0313" y2="644.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="132" x="265" y="639.0981">chi_override_flush</text><polygon fill="#A80036" points="573,669.1641,583,673.1641,573,677.1641,577,673.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="419" x2="579" y1="673.1641" y2="673.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="426" y="668.231">OverrideFlush</text><polygon fill="#FBFB77" filter="url(#f1biwn2u6uayja)" points="600,686.2969,600,726.2969,897,726.2969,897,696.2969,887,686.2969,600,686.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="887" x2="887" y1="686.2969" y2="696.2969"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="897" x2="887" y1="696.2969" y2="696.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="606" y="703.3638">set</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="630" y="703.3638">m_aFlushInProgress = TRUE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="606" y="718.4966">other thread will read this and stop process</text><rect fill="none" height="175.0625" style="stroke: #000000; stroke-width: 2.0;" width="603" x="499" y="742.5625"/><polygon fill="#EEEEEE" points="499,742.5625,563,742.5625,563,749.5625,553,759.5625,499,759.5625,499,742.5625" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="514" y="755.6294">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="578" y="754.7729">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="583" y="754.7729">m_pSelectedUsecase</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="718" y="754.7729">]</text><polygon fill="#A80036" points="714.5,776.6953,724.5,780.6953,714.5,784.6953,718.5,780.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="595" x2="720.5" y1="780.6953" y2="780.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="39" x="602" y="775.7622">Flush</text><polygon fill="#FBFB77" filter="url(#f1biwn2u6uayja)" points="741,793.8281,741,878.8281,1088,878.8281,1088,803.8281,1078,793.8281,741,793.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1078" x2="1078" y1="793.8281" y2="803.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1078" y1="803.8281" y2="803.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="747" y="810.895">usecase will run</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="109" x="851" y="810.895">ExecuteFlush()</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="747" y="826.0278">--&gt;FlushAllSessions()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="747" y="841.1606">this finally call</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="234" x="839" y="841.1606">g_chiContextOps.pFlushSession</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="747" y="856.2935">CamX::ChiFlushSession</text><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="852" y="871.4263">-&gt; Session::Flush()</text><polygon fill="#A80036" points="606,905.4922,596,909.4922,606,913.4922,602,909.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="600" x2="730.5" y1="909.4922" y2="909.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="612" y="904.5591">return</text><polygon fill="#A80036" points="430,941.625,420,945.625,430,949.625,426,945.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="424" x2="589" y1="945.625" y2="945.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="436" y="940.6919">return</text><polygon fill="#A80036" points="269,970.7578,259,974.7578,269,978.7578,265,974.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="263" x2="413" y1="974.7578" y2="974.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="275" y="969.8247">return</text><polygon fill="#A80036" points="22,999.8906,12,1003.8906,22,1007.8906,18,1003.8906" style="stroke: #A80036; stroke-width: 1.0;"/><ellipse cx="252.5" cy="1003.1406" fill="none" rx="4" ry="4" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="16" x2="248" y1="1003.8906" y2="1003.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="28" y="998.9575">return</text><!--
@startuml

participant camxhaldevice

participant chxextensioninterface
participant chxextensionmodule
box "Usecase"
participant chxusecase
end box

participant camxsession
participant B
== <color:blue> How the camx keep request in a queue </color>==

== <color:blue> **What will happen when app call a flush** </color>==
... ...
[o->camxsession: Flush()
activate camxsession
  alt **m_sessionInitComplete == FALSE**
  else
    camxsession->camxsession: FlushHALQueue()
    activate camxsession
      note right camxsession
        <color:red>m_pRequestQueue->Dequeue</color> all the request, and
        run **PrepareAndDispatchRequestError**, which
        will return MessageTypeError and then release the request
        the <color:red>**HAL3Queue::EnqueueWait**</color>, will wait for 
        release and can enqueue a new request
      end note
    camxsession->camxsession: return
    deactivate camxsession
  end
[o<-camxsession: return
deactivate camxsession
... ...
== <color:blue> **Flush called from APP** </color>==
note left camxhaldevice
  App call flush and will go into here
end note
[o->camxhaldevice: **Flush()**
activate camxhaldevice
  camxhaldevice->chxextensioninterface: **chi_override_flush**
  activate chxextensioninterface
    chxextensioninterface->chxextensionmodule: **OverrideFlush**
    activate chxextensionmodule
      note right chxextensionmodule
        set **m_aFlushInProgress = TRUE**
        other thread will read this and stop process
      end note
      alt **m_pSelectedUsecase**
        chxextensionmodule->chxusecase: **Flush**
        activate chxusecase
          note right chxusecase
            usecase will run <color:blue>**ExecuteFlush()**</color>
            **- ->FlushAllSessions()**
            this finally call **g_chiContextOps.pFlushSession**
            <color:blue>**CamX::ChiFlushSession                   **</color>
            <color:blue>**                     -> Session::Flush()**</color>
          end note
        chxextensionmodule<-chxusecase: return
        deactivate chxusecase
      end
    chxextensioninterface<-chxextensionmodule: **return**
    deactivate chxextensionmodule
  camxhaldevice<-chxextensioninterface: return
  deactivate chxextensioninterface
[o<-camxhaldevice: **return**
deactivate camxhaldevice



@enduml

PlantUML version 1.2017.20(Mon Dec 11 16:57:05 GMT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_171-8u171-b11-0ubuntu0.16.04.1-b11
Operating System: Linux
OS Version: 4.4.0-43-Microsoft
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>