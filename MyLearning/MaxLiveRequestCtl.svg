<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="630px" preserveAspectRatio="none" style="width:787px;height:630px;" version="1.1" viewBox="0 0 787 630" width="787px" zoomAndPan="magnify"><defs><filter height="300%" id="f1e0gzggpdzdb1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="171" x="305" y="28.708">MaxLiveRequestCtl</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="54" x="381.5" y="49.6611">Lin Jin</text><rect fill="#DDDDDD" height="562.3203" style="stroke:#A80036;stroke-width:1.0;" width="308" x="100.5" y="61.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63" x="223" y="73.9731">feature2</text><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="53.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="165" y="147.4688"/><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="126.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="165" y="257.7344"/><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="126.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="165" y="441.3984"/><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="83.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="444.5" y="286.8672"/><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="83.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="444.5" y="470.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="169.5" x2="169.5" y1="116.3359" y2="208.6016"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="169.5" x2="169.5" y1="208.6016" y2="236.6016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="169.5" x2="169.5" y1="236.6016" y2="392.2656"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="169.5" x2="169.5" y1="392.2656" y2="420.2656"/><line style="stroke:#A80036;stroke-width:1.0;" x1="169.5" x2="169.5" y1="420.2656" y2="585.9297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="324.5" x2="324.5" y1="116.3359" y2="208.6016"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="324.5" x2="324.5" y1="208.6016" y2="236.6016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="324.5" x2="324.5" y1="236.6016" y2="392.2656"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="324.5" x2="324.5" y1="392.2656" y2="420.2656"/><line style="stroke:#A80036;stroke-width:1.0;" x1="324.5" x2="324.5" y1="420.2656" y2="585.9297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="449.5" x2="449.5" y1="116.3359" y2="208.6016"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="449.5" x2="449.5" y1="208.6016" y2="236.6016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="449.5" x2="449.5" y1="236.6016" y2="392.2656"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="449.5" x2="449.5" y1="392.2656" y2="420.2656"/><line style="stroke:#A80036;stroke-width:1.0;" x1="449.5" x2="449.5" y1="420.2656" y2="585.9297"/><rect fill="#FEFECE" filter="url(#f1e0gzggpdzdb1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="127" x="104.5" y="81.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="111.5" y="101.0342">feature2realtime</text><rect fill="#FEFECE" filter="url(#f1e0gzggpdzdb1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="127" x="104.5" y="584.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="111.5" y="604.9248">feature2realtime</text><rect fill="#FEFECE" filter="url(#f1e0gzggpdzdb1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="155" x="245.5" y="81.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="252.5" y="101.0342">feature2realtimemcx</text><rect fill="#FEFECE" filter="url(#f1e0gzggpdzdb1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="155" x="245.5" y="584.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="252.5" y="604.9248">feature2realtimemcx</text><rect fill="#FEFECE" filter="url(#f1e0gzggpdzdb1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="66" x="414.5" y="81.0391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="421.5" y="101.0342">chxutils</text><rect fill="#FEFECE" filter="url(#f1e0gzggpdzdb1)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="66" x="414.5" y="584.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="421.5" y="604.9248">chxutils</text><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="53.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="165" y="147.4688"/><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="126.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="165" y="257.7344"/><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="126.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="165" y="441.3984"/><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="83.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="444.5" y="286.8672"/><rect fill="#FFFFFF" filter="url(#f1e0gzggpdzdb1)" height="83.3984" style="stroke:#A80036;stroke-width:1.0;" width="10" x="444.5" y="470.5313"/><ellipse cx="7.5" cy="146.7188" fill="none" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#A80036" points="153,143.4688,163,147.4688,153,151.4688,157,147.4688" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="12" x2="159" y1="147.4688" y2="147.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137" x="15" y="142.4028">OnSessionCreate()</text><path d="M180,160.4688 L180,185.4688 L466,185.4688 L466,170.4688 L456,160.4688 L180,160.4688 " fill="#FBFB77" filter="url(#f1e0gzggpdzdb1)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M456,160.4688 L456,170.4688 L466,170.4688 L456,160.4688 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265" x="186" y="177.5356">Semaphore::Create(maxHalRequests - 1)</text><polygon fill="#A80036" points="11,196.6016,1,200.6016,11,204.6016,7,200.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="5" x2="169" y1="200.6016" y2="200.6016"/><ellipse cx="7.5" cy="256.9844" fill="none" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#A80036" points="153,253.7344,163,257.7344,153,261.7344,157,257.7344" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="12" x2="159" y1="257.7344" y2="257.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="136" x="15" y="252.6685">AcquireResource()</text><polygon fill="#A80036" points="432.5,282.8672,442.5,286.8672,432.5,290.8672,436.5,286.8672" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="175" x2="438.5" y1="286.8672" y2="286.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="153" x="182" y="281.8013">WaitForSemaphore()</text><path d="M459,299.8672 L459,354.8672 L778,354.8672 L778,309.8672 L768,299.8672 L459,299.8672 " fill="#FBFB77" filter="url(#f1e0gzggpdzdb1)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M768,299.8672 L768,309.8672 L778,309.8672 L768,299.8672 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="465" y="316.9341">std::unique_lock&lt;std::mutex&gt; lock(m_mutex);</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="465" y="332.0669">while (m_semaphoreCount == 0)  wait</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="465" y="347.1997">m_semaphoreCount--</text><polygon fill="#A80036" points="186,366.2656,176,370.2656,186,374.2656,182,370.2656" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="180" x2="448.5" y1="370.2656" y2="370.2656"/><polygon fill="#A80036" points="11,380.2656,1,384.2656,11,388.2656,7,384.2656" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="5" x2="169" y1="384.2656" y2="384.2656"/><ellipse cx="7.5" cy="440.6484" fill="none" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;"/><polygon fill="#A80036" points="153,437.3984,163,441.3984,153,445.3984,157,441.3984" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="12" x2="159" y1="441.3984" y2="441.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138" x="15" y="436.3325">ReleaseResource()</text><polygon fill="#A80036" points="432.5,466.5313,442.5,470.5313,432.5,474.5313,436.5,470.5313" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="175" x2="438.5" y1="470.5313" y2="470.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125" x="182" y="465.4653">NotifyAllThread()</text><path d="M459,483.5313 L459,538.5313 L778,538.5313 L778,493.5313 L768,483.5313 L459,483.5313 " fill="#FBFB77" filter="url(#f1e0gzggpdzdb1)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M768,483.5313 L768,493.5313 L778,493.5313 L768,483.5313 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="465" y="500.5981">std::unique_lock&lt;std::mutex&gt; lock(m_mutex);</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="465" y="515.731">m_semaphoreCount++</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="465" y="530.8638">m_semaphoreCv.notify_all()</text><polygon fill="#A80036" points="186,549.9297,176,553.9297,186,557.9297,182,553.9297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="180" x2="448.5" y1="553.9297" y2="553.9297"/><polygon fill="#A80036" points="11,563.9297,1,567.9297,11,571.9297,7,567.9297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="5" x2="169" y1="567.9297" y2="567.9297"/><!--MD5=[5cc3c02d0066dd1003a3ff5b17206ff5]
@startuml
title <size:18>MaxLiveRequestCtl </size>\n     Lin Jin

box "feature2"
    participant feature2realtime
    participant feature2realtimemcx
end box
participant chxutils


[o->feature2realtime: **OnSessionCreate()**
activate feature2realtime
    note right feature2realtime
        Semaphore::Create(maxHalRequests - 1)
    end note
[<-feature2realtime:
deactivate feature2realtime

......
[o->feature2realtime: **AcquireResource()**
activate feature2realtime
    feature2realtime->chxutils: **WaitForSemaphore()**
    activate chxutils
        note right chxutils
            std::unique_lock<std::mutex> lock(m_mutex);
            while (m_semaphoreCount == 0)  wait
            m_semaphoreCount- -
        end note
    chxutils->feature2realtime:
    deactivate chxutils
[<-feature2realtime:
deactivate feature2realtime

......
[o->feature2realtime: **ReleaseResource()**
activate feature2realtime
    feature2realtime->chxutils: **NotifyAllThread()**
    activate chxutils
        note right chxutils
            std::unique_lock<std::mutex> lock(m_mutex);
            m_semaphoreCount++
            m_semaphoreCv.notify_all()
        end note
    chxutils->feature2realtime:
    deactivate chxutils
[<-feature2realtime:
deactivate feature2realtime

@enduml

PlantUML version 1.2021.00(Sun Jan 10 18:25:05 CST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: ANSI_X3.4-1968
Language: en
Country: US
--></g></svg>