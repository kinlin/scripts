<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2099px" preserveAspectRatio="none" style="width:1008px;height:2099px;" version="1.1" viewBox="0 0 1008 2099" width="1008px" zoomAndPan="magnify"><defs><filter height="300%" id="f1p4jpbkjb7of7" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="437.75" y="22.9951">ThreadManager</text><rect fill="#FAFAD2" height="2054.2188" style="stroke: #A80036; stroke-width: 1.0;" width="119" x="15" y="34.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="58.5" y="46.3638">user</text><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="965.1875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="226.5" y="181.8594"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="891.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="231.5" y="219.125"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="228.3906" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="226.5" y="1310.4766"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="288.125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="226.5" y="1612.2969"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="77.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="464.5" y="253.2578"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="62.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="629.5" y="359.7891"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="579.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="777.5" y="496.1875"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="305" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="782.5" y="727.6484"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="103.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="787.5" y="793.9141"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="430.5313" style="stroke: #000000; stroke-width: 2.0;" width="398" x="555" y="617.25"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="50.2656" style="stroke: #000000; stroke-width: 2.0;" width="250" x="693" y="641.3828"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="221.7344" style="stroke: #000000; stroke-width: 2.0;" width="263.5" x="654" y="747.7813"/><rect fill="#FFFFFF" height="56.9375" style="stroke: none; stroke-width: 1.0;" width="263.5" x="654" y="912.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="74" x2="74" y1="92.7266" y2="2046.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="231.5" x2="231.5" y1="92.7266" y2="2046.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="469" x2="469" y1="92.7266" y2="2046.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="634" x2="634" y1="92.7266" y2="2046.2188"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="782.5" x2="782.5" y1="92.7266" y2="2046.2188"/><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="23" y="53.4297"/><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="19" y="57.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="26" y="77.4248">ThreadUsers</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="23" y="2045.2188"/><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="19" y="2049.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="26" y="2069.2139">ThreadUsers</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="151.5" y="57.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="142" x="158.5" y="77.4248">camxthreadmanager</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="151.5" y="2045.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="142" x="158.5" y="2065.2139">camxthreadmanager</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="167" x="384" y="57.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="153" x="391" y="77.4248">camxthreadjobregistry</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="167" x="384" y="2045.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="153" x="391" y="2065.2139">camxthreadjobregistry</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="135" x="565" y="57.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="572" y="77.4248">camxthreadjoblist</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="135" x="565" y="2045.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="572" y="2065.2139">camxthreadjoblist</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="717.5" y="57.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="724.5" y="77.4248">camxthreadcore</text><rect fill="#FEFECE" filter="url(#f1p4jpbkjb7of7)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="717.5" y="2045.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="724.5" y="2065.2139">camxthreadcore</text><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="965.1875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="226.5" y="181.8594"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="891.7891" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="231.5" y="219.125"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="228.3906" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="226.5" y="1310.4766"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="288.125" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="226.5" y="1612.2969"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="77.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="464.5" y="253.2578"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="62.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="629.5" y="359.7891"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="579.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="777.5" y="496.1875"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="305" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="782.5" y="727.6484"/><rect fill="#FFFFFF" filter="url(#f1p4jpbkjb7of7)" height="103.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="787.5" y="793.9141"/><rect fill="#EEEEEE" filter="url(#f1p4jpbkjb7of7)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="993.5" x="3" y="123.293"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="996.5" y1="123.293" y2="123.293"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="996.5" y1="126.293" y2="126.293"/><rect fill="#EEEEEE" filter="url(#f1p4jpbkjb7of7)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="157" x="421.25" y="112.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="427.25" y="128.7935">thread Pool create</text><polygon fill="#A80036" points="214.5,177.8594,224.5,181.8594,214.5,185.8594,218.5,181.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3" x2="220.5" y1="181.8594" y2="181.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="10" y="161.9263">ThreadManager::Create</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="10" y="177.0591">(pName,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="70" y="177.0591">numThreads</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="161" y="177.0591">)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="283.5" y1="206.2578" y2="206.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="283.5" x2="283.5" y1="206.2578" y2="219.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="283.5" y1="219.2578" y2="219.2578"/><polygon fill="#A80036" points="252.5,215.2578,242.5,219.2578,252.5,223.2578,248.5,219.2578" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="248.5" y="201.1919">Initialize</text><polygon fill="#A80036" points="452.5,249.2578,462.5,253.2578,452.5,257.2578,456.5,253.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="241.5" x2="458.5" y1="253.2578" y2="253.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="204" x="248.5" y="248.3247">m_pJobRegistry-&gt;Initialize()</text><rect fill="#FBFB77" filter="url(#f1p4jpbkjb7of7)" height="38" style="stroke: #A80036; stroke-width: 1.0;" width="245" x="347" y="266.3906"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="351" y="282.4575">Mutex::Create("JobRegistry")</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="351" y="297.5903">Mutex::Create("FlushJobSubmitLock")</text><polygon fill="#A80036" points="252.5,326.6563,242.5,330.6563,252.5,334.6563,248.5,330.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246.5" x2="468.5" y1="330.6563" y2="330.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="258.5" y="325.7231">return</text><polygon fill="#A80036" points="617.5,355.7891,627.5,359.7891,617.5,363.7891,621.5,359.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="241.5" x2="623.5" y1="359.7891" y2="359.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="284" x="248.5" y="354.856">m_pJobList-&gt;Initialize(m_pJobRegistry)</text><rect fill="#FBFB77" filter="url(#f1p4jpbkjb7of7)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="159" x="555" y="372.9219"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="559" y="388.9888">Mutex::Create("JobList")</text><polygon fill="#A80036" points="252.5,418.0547,242.5,422.0547,252.5,426.0547,248.5,422.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246.5" x2="633.5" y1="422.0547" y2="422.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="258.5" y="417.1216">return</text><polygon fill="#A80036" points="765.5,492.1875,775.5,496.1875,765.5,500.1875,769.5,496.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="241.5" x2="771.5" y1="496.1875" y2="496.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="248.5" y="446.2544">m_pCore-&gt;Initialize</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="390.5" y="446.2544">(m_pJobRegistry,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="252.5" y="461.3872">m_pJobList,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="248.5" y="476.52">pName,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="248.5" y="491.6528">m_numThreads)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="787.5" x2="829.5" y1="525.8516" y2="525.8516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="829.5" x2="829.5" y1="525.8516" y2="538.8516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="788.5" x2="829.5" y1="538.8516" y2="538.8516"/><polygon fill="#A80036" points="798.5,534.8516,788.5,538.8516,798.5,542.8516,794.5,538.8516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="190" x="794.5" y="520.7856">ThreadCore::StartThreads</text><rect fill="#FBFB77" filter="url(#f1p4jpbkjb7of7)" height="53" style="stroke: #A80036; stroke-width: 1.0;" width="389" x="588" y="551.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="592" y="567.9185">OsUtils::ThreadCreate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="592" y="583.0513">workThreadFunc</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="592" y="598.1841">create numThreads thread and run</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="820" y="598.1841">ThreadCore::DoWork</text><rect fill="none" height="430.5313" style="stroke: #000000; stroke-width: 2.0;" width="398" x="555" y="617.25"/><polygon fill="#EEEEEE" points="555,617.25,790,617.25,790,624.25,780,634.25,555,634.25,555,617.25" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="190" x="570" y="630.3169">ThreadCore::DoWork loop</text><rect fill="none" height="50.2656" style="stroke: #000000; stroke-width: 2.0;" width="250" x="693" y="641.3828"/><polygon fill="#EEEEEE" points="693,641.3828,757,641.3828,757,648.3828,747,658.3828,693,658.3828,693,641.3828" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="708" y="654.4497">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="772" y="653.5933">[if</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="143" x="790" y="653.5933">p_jobPending==FALSE</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="933" y="653.5933">]</text><rect fill="#FBFB77" filter="url(#f1p4jpbkjb7of7)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="159" x="703" y="663.5156"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="707" y="679.5825">m_pReadOK-&gt;Wait()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="787.5" x2="834.5" y1="714.7813" y2="714.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="834.5" x2="834.5" y1="714.7813" y2="727.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="793.5" x2="834.5" y1="727.7813" y2="727.7813"/><polygon fill="#A80036" points="803.5,723.7813,793.5,727.7813,803.5,731.7813,799.5,727.7813" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="799.5" y="709.7153">ProcessJobQueue</text><rect fill="none" height="221.7344" style="stroke: #000000; stroke-width: 2.0;" width="263.5" x="654" y="747.7813"/><polygon fill="#EEEEEE" points="654,747.7813,718,747.7813,718,754.7813,708,764.7813,654,764.7813,654,747.7813" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="669" y="760.8481">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="733" y="759.9917">[JobStatus::Ready]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="792.5" x2="839.5" y1="781.0469" y2="781.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="839.5" x2="839.5" y1="781.0469" y2="794.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="798.5" x2="839.5" y1="794.0469" y2="794.0469"/><polygon fill="#A80036" points="808.5,790.0469,798.5,794.0469,808.5,798.0469,804.5,794.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="804.5" y="775.981">DispatchJob</text><rect fill="#FBFB77" filter="url(#f1p4jpbkjb7of7)" height="53" style="stroke: #A80036; stroke-width: 1.0;" width="237" x="664" y="812.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="668" y="828.1138">This is the place run callback</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="668" y="843.2466">func = m_pJobregistry-&gt;GetJobFunc</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="164" x="668" y="858.3794">func(pJob-&gt;pData[0]);</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="797.5" x2="839.5" y1="896.5781" y2="896.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="839.5" x2="839.5" y1="896.5781" y2="909.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="792.5" x2="839.5" y1="909.5781" y2="909.5781"/><polygon fill="#A80036" points="802.5,905.5781,792.5,909.5781,802.5,913.5781,798.5,909.5781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="804.5" y="891.5122">return</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="654" x2="917.5" y1="913.5781" y2="913.5781"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="132" x="659" y="923.7886">[JobStatus::Stopped]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="792.5" x2="834.5" y1="948.5156" y2="948.5156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="834.5" x2="834.5" y1="948.5156" y2="961.5156"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="793.5" x2="834.5" y1="961.5156" y2="961.5156"/><polygon fill="#A80036" points="803.5,957.5156,793.5,961.5156,803.5,965.5156,799.5,961.5156" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="799.5" y="943.4497">OnJobStopped</text><polygon fill="#A80036" points="645.5,993.5156,635.5,997.5156,645.5,1001.5156,641.5,997.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="639.5" x2="781.5" y1="997.5156" y2="997.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="651.5" y="992.5825">ReleaseJobEntry</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="792.5" x2="834.5" y1="1031.7813" y2="1031.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="834.5" x2="834.5" y1="1031.7813" y2="1044.7813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="787.5" x2="834.5" y1="1044.7813" y2="1044.7813"/><polygon fill="#A80036" points="797.5,1040.7813,787.5,1044.7813,797.5,1048.7813,793.5,1044.7813" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="799.5" y="1026.7153">return</text><polygon fill="#A80036" points="252.5,1071.7813,242.5,1075.7813,252.5,1079.7813,248.5,1075.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246.5" x2="781.5" y1="1075.7813" y2="1075.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="258.5" y="1070.8481">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="241.5" x2="283.5" y1="1110.0469" y2="1110.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="283.5" x2="283.5" y1="1110.0469" y2="1123.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="283.5" y1="1123.0469" y2="1123.0469"/><polygon fill="#A80036" points="246.5,1119.0469,236.5,1123.0469,246.5,1127.0469,242.5,1123.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="248.5" y="1104.981">return</text><polygon fill="#A80036" points="14,1143.0469,4,1147.0469,14,1151.0469,10,1147.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="8" x2="230.5" y1="1147.0469" y2="1147.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="20" y="1142.1138">return</text><rect fill="#EEEEEE" filter="url(#f1p4jpbkjb7of7)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="993.5" x="3" y="1176.3281"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="996.5" y1="1176.3281" y2="1176.3281"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="996.5" y1="1179.3281" y2="1179.3281"/><rect fill="#EEEEEE" filter="url(#f1p4jpbkjb7of7)" height="24.2969" style="stroke: #000000; stroke-width: 2.0;" width="173" x="413.25" y="1165.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="424.25" y="1182.1748"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149" x="424.25" y="1182.1748">thread job register</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="578.25" y="1182.1748"/><polygon fill="#A80036" points="214.5,1306.4766,224.5,1310.4766,214.5,1314.4766,218.5,1310.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74.5" x2="220.5" y1="1310.4766" y2="1310.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="81.5" y="1215.5435">RegisterJobFamily</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="85.5" y="1230.6763">jobFuncAddr</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="85.5" y="1245.8091">jobFuncName</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="85.5" y="1260.9419">flushDoneCb</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="85.5" y="1276.0747">priority</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="85.5" y="1291.2075">isSerialize</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="85.5" y="1306.3403">phJob</text><polygon fill="#A80036" points="457.5,1336.4063,467.5,1340.4063,457.5,1344.4063,461.5,1340.4063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="463.5" y1="1340.4063" y2="1340.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="243.5" y="1335.4731">RegisterNewJob</text><rect fill="#FBFB77" filter="url(#f1p4jpbkjb7of7)" height="159" style="stroke: #A80036; stroke-width: 1.0;" width="543" x="79" y="1353.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="83" y="1369.606">param Explain:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="91" y="1384.7388"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="91" y="1384.7388">jobFuncAddr</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="174" y="1384.7388">thread func, that always waiting for process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="91" y="1399.8716"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="91" y="1399.8716">jobFuncName</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="183" y="1399.8716">call ThreadSetName set name</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="91" y="1415.0044"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="91" y="1415.0044">flushDoneCb</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="353" x="176" y="1415.0044">when ThreadCore::StopThreads will CheckAllFlushDOne,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="119" y="1430.1372">This cb will tell the user now the thread is stoped and flush done</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="91" y="1445.27"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="91" y="1445.27">priority</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="151" y="1445.27">in ProcessJobQueue, we will check from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="338" x="119" y="1460.4028">0-critical to 1-High; 2-Normal, and process onebyone</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="91" y="1475.5356"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="91" y="1475.5356">isSerialize</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="459" x="159" y="1475.5356">if set True,for the same family will process onebyone first in first process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="316" x="119" y="1490.6685">otherwise will may not follow this  ?? need confirm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="91" y="1505.8013"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="91" y="1505.8013">phJob</text><polygon fill="#A80036" points="85.5,1534.8672,75.5,1538.8672,85.5,1542.8672,81.5,1538.8672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79.5" x2="230.5" y1="1538.8672" y2="1538.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="91.5" y="1533.9341">return</text><rect fill="#EEEEEE" filter="url(#f1p4jpbkjb7of7)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="993.5" x="3" y="1568.1484"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="996.5" y1="1568.1484" y2="1568.1484"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="996.5" y1="1571.1484" y2="1571.1484"/><rect fill="#EEEEEE" filter="url(#f1p4jpbkjb7of7)" height="24.2969" style="stroke: #000000; stroke-width: 2.0;" width="140" x="429.75" y="1557"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="440.75" y="1573.9951"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="440.75" y="1573.9951">thread PostJob</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="561.75" y="1573.9951"/><polygon fill="#A80036" points="214.5,1608.2969,224.5,1612.2969,214.5,1616.2969,218.5,1612.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74.5" x2="220.5" y1="1612.2969" y2="1612.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="81.5" y="1607.3638">PostJob</text><polygon fill="#A80036" points="770.5,1637.4297,780.5,1641.4297,770.5,1645.4297,774.5,1641.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="236.5" x2="776.5" y1="1641.4297" y2="1641.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="243.5" y="1636.4966">AcceptNewJob</text><rect fill="#FBFB77" filter="url(#f1p4jpbkjb7of7)" height="219" style="stroke: #A80036; stroke-width: 1.0;" width="538" x="79" y="1654.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="83" y="1670.6294">param Explain:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="83" y="1685.7622">hJob</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="114" y="1685.7622">Handle to the job returned from</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="321" y="1685.7622">RegisterJobFamily</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="83" y="1700.895">stoppedCb</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="341" x="156" y="1700.895">Job Stopped CB for this job, if this job family is flushed</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="501" y="1700.895">RegisterJobFamily</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="83" y="1716.0278">ppData</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="134" y="1716.0278">Array or 1 or more partitioned data</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="362" y="1716.0278">RegisterJobFamily</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="99" y="1731.1606">this param is used as callback param,</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="345" y="1731.1606">func(pJob-&gt;pData[0])</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="83" y="1746.2935">isSplitable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="152" y="1746.2935">If the job can be partitioned</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="331" y="1746.2935">RegisterJobFamily</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="83" y="1761.4263">isBlocking</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="150" y="1761.4263">If the caller of the job blocks on its completion</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="446" y="1761.4263">RegisterJobFamily</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="87" y="1776.5591"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="83" y="1791.6919">Mainly task:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="91" y="1806.8247">1. add the to JobQueue</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="103" y="1821.9575"/><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="147" x="103" y="1821.9575">AddToPriorityQueue</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="91" y="1837.0903">2. start Trigger thread loop,  which wait in</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="58" x="357" y="1837.0903">DoWork</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="103" y="1852.2231"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="103" y="1852.2231">m_jobPending=TRUE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="103" y="1867.356"/><text fill="#0000FF" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="103" y="1867.356">m_pReadOK-&gt;Signal</text><polygon fill="#A80036" points="85.5,1896.4219,75.5,1900.4219,85.5,1904.4219,81.5,1900.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79.5" x2="230.5" y1="1900.4219" y2="1900.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="91.5" y="1895.4888">return</text><rect fill="#EEEEEE" filter="url(#f1p4jpbkjb7of7)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="993.5" x="3" y="1929.1211"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="996.5" y1="1929.1211" y2="1929.1211"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="996.5" y1="1932.1211" y2="1932.1211"/><rect fill="#EEEEEE" filter="url(#f1p4jpbkjb7of7)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="284" x="357.75" y="1918.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="265" x="363.75" y="1934.6216">How many place create thread pool</text><polygon fill="#FBFB77" filter="url(#f1p4jpbkjb7of7)" points="8,1956.6875,8,2026.6875,223,2026.6875,223,1966.6875,213,1956.6875,8,1956.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="213" x2="213" y1="1956.6875" y2="1966.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="223" x2="213" y1="1966.6875" y2="1966.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="14" y="1973.7544">ThreadManager:Create</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="14" y="1988.8872">camxchicontext.cpp: 94</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="194" x="14" y="2004.02">camxcslcommonutils.cpp: 478</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="14" y="2019.1528">camxsyncmanager.cpp: 212</text><!--
@startuml
title ThreadManager

box "user" #LightGoldenRodYellow
collections ThreadUsers
end box
participant camxthreadmanager
participant camxthreadjobregistry
participant camxthreadjoblist
participant camxthreadcore


== thread Pool create ==
[->camxthreadmanager: **ThreadManager::Create**\n(pName, **numThreads**)
activate camxthreadmanager

  camxthreadmanager->camxthreadmanager: Initialize
  activate camxthreadmanager

    camxthreadmanager->camxthreadjobregistry: **m_pJobRegistry->Initialize()**
    activate camxthreadjobregistry
      rnote over camxthreadjobregistry
        <color:blue>Mutex::Create("JobRegistry")
        <color:blue>Mutex::Create("FlushJobSubmitLock")
      end rnote
    camxthreadjobregistry->camxthreadmanager: return
    deactivate camxthreadjobregistry


    camxthreadmanager->camxthreadjoblist: **m_pJobList->Initialize(m_pJobRegistry)**
    activate camxthreadjoblist
      rnote over camxthreadjoblist
        <color:blue>Mutex::Create("JobList")
      end rnote
    camxthreadjoblist->camxthreadmanager: return
    deactivate camxthreadjoblist


    camxthreadmanager->camxthreadcore: **m_pCore->Initialize**(m_pJobRegistry,\n m_pJobList,\npName,\nm_numThreads)
    activate camxthreadcore
      camxthreadcore->camxthreadcore: <color:red>**ThreadCore::StartThreads**
      rnote over camxthreadcore
        OsUtils::ThreadCreate
        workThreadFunc
        create numThreads thread and run **ThreadCore::DoWork**
      end rnote

      group ThreadCore::DoWork loop
        alt if **p_jobPending==FALSE**
          rnote over camxthreadcore
            <color:blue>**m_pReadOK->Wait()**</color>
          end rnote
        end
        camxthreadcore->camxthreadcore: **ProcessJobQueue**
        activate camxthreadcore
          alt JobStatus::Ready
            camxthreadcore->camxthreadcore: **DispatchJob**
            activate camxthreadcore
              rnote over camxthreadcore
              This is the place run callback
              func = m_pJobregistry->GetJobFunc
              <color:red>**func(pJob->pData[0]);**
              end rnote
            camxthreadcore->camxthreadcore: return
            deactivate camxthreadcore
          else JobStatus::Stopped
            camxthreadcore->camxthreadcore: **OnJobStopped**
          end
        camxthreadcore->camxthreadjoblist: **ReleaseJobEntry**
        camxthreadcore->camxthreadcore: return
        deactivate camxthreadcore
      end

    camxthreadcore->camxthreadmanager: return
    deactivate camxthreadcore

  camxthreadmanager->camxthreadmanager: return
  deactivate camxthreadmanager
[<-camxthreadmanager: return
deactivate camxthreadmanager

==<size:14> **thread job register** </size>==
ThreadUsers->camxthreadmanager: **RegisterJobFamily**\n jobFuncAddr\n jobFuncName\n flushDoneCb\n priority\n isSerialize\n phJob
activate camxthreadmanager
camxthreadmanager->camxthreadjobregistry: **RegisterNewJob**
rnote right ThreadUsers
param Explain:
  <color:red>jobFuncAddr</color> thread func, that always waiting for process
  <color:red>jobFuncName</color> call ThreadSetName set name
  <color:red>flushDoneCb</color> when ThreadCore::StopThreads will CheckAllFlushDOne,
         This cb will tell the user now the thread is stoped and flush done
  <color:red>priority   </color> in ProcessJobQueue, we will check from
         0-critical to 1-High; 2-Normal, and process onebyone
  <color:red>isSerialize</color> if set True,for the same family will process onebyone first in first process
         otherwise will may not follow this  ?? need confirm
  <color:red>phJob</color>
end rnote
camxthreadmanager->ThreadUsers: return
deactivate camxthreadmanager

==<size:14> **thread PostJob** </size>==
ThreadUsers->camxthreadmanager: **PostJob**
activate camxthreadmanager
camxthreadmanager->camxthreadcore: **AcceptNewJob**
rnote right ThreadUsers
  param Explain:
  <color:red>hJob</color> Handle to the job returned from <color:red>RegisterJobFamily</color>
  <color:red>stoppedCb</color> Job Stopped CB for this job, if this job family is flushed <color:red>RegisterJobFamily</color>
  <color:red>ppData</color> Array or 1 or more partitioned data <color:red>RegisterJobFamily</color>
      this param is used as callback param, <color:red>func(pJob->pData[0])
  <color:red>isSplitable</color> If the job can be partitioned <color:red>RegisterJobFamily</color>
  <color:red>isBlocking</color> If the caller of the job blocks on its completion <color:red>RegisterJobFamily</color>
  
  Mainly task:
    1. add the to JobQueue   
       <color:red>**AddToPriorityQueue**</color>
    2. start Trigger thread loop,  which wait in <color:red>**DoWork**</color>
       <color:blue>**m_jobPending=TRUE**</color>
       <color:blue>**m_pReadOK->Signal**</color>
end rnote

camxthreadmanager->ThreadUsers: return
deactivate camxthreadmanager

== How many place create thread pool ==

note left camxthreadmanager
  ThreadManager:Create
  camxchicontext.cpp: 94
  camxcslcommonutils.cpp: 478
  camxsyncmanager.cpp: 212
end note



@enduml

PlantUML version 1.2017.20(Mon Dec 11 16:57:05 GMT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_171-8u171-b11-0ubuntu0.16.04.1-b11
Operating System: Linux
OS Version: 4.4.0-43-Microsoft
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>