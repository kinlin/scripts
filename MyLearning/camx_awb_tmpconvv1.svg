<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1488px" preserveAspectRatio="none" style="width:994px;height:1488px;" version="1.1" viewBox="0 0 994 1488" width="994px" zoomAndPan="magnify"><defs><filter height="300%" id="fg6bcekwdl6lb" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="264" x="360.5" y="26.708">camx awb scenechangev1</text><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="1243.9063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="202.5" y="186.5156"/><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="1170.6406" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="387.5" y="230.6484"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="139.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="267.9141"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="491.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="451.8438"/><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="322.6563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="397.5" y="578.5078"/><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="94.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="402.5" y="620.6406"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="94.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="987.4297"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="154.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="1125.9609"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="40.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="1325.0234"/><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="129.9922" style="stroke: #000000; stroke-width: 2.0;" width="394" x="402" y="737.1719"/><rect fill="#FFFFFF" height="73.7266" style="stroke: none; stroke-width: 1.0;" width="394" x="402" y="793.4375"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="47" x2="47" y1="73.25" y2="1448.5547"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="207.5" x2="207.5" y1="73.25" y2="1448.5547"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="392" x2="392" y1="73.25" y2="1448.5547"/><rect fill="#FEFECE" filter="url(#fg6bcekwdl6lb)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="8" y="37.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="15" y="57.9482">awbmain</text><rect fill="#FEFECE" filter="url(#fg6bcekwdl6lb)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="8" y="1447.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="15" y="1467.5498">awbmain</text><rect fill="#FEFECE" filter="url(#fg6bcekwdl6lb)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="146.5" y="37.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="153.5" y="57.9482">awbtmpconvv1</text><rect fill="#FEFECE" filter="url(#fg6bcekwdl6lb)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="146.5" y="1447.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="153.5" y="1467.5498">awbtmpconvv1</text><rect fill="#FEFECE" filter="url(#fg6bcekwdl6lb)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="314" y="37.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="321" y="57.9482">awbscenechangev1</text><rect fill="#FEFECE" filter="url(#fg6bcekwdl6lb)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="314" y="1447.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="139" x="321" y="1467.5498">awbscenechangev1</text><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="1243.9063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="202.5" y="186.5156"/><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="1170.6406" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="387.5" y="230.6484"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="139.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="267.9141"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="491.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="451.8438"/><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="322.6563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="397.5" y="578.5078"/><rect fill="#FFFFFF" filter="url(#fg6bcekwdl6lb)" height="94.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="402.5" y="620.6406"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="94.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="987.4297"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="154.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="1125.9609"/><rect fill="#FA8072" filter="url(#fg6bcekwdl6lb)" height="40.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="392.5" y="1325.0234"/><rect fill="#EEEEEE" filter="url(#fg6bcekwdl6lb)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="979" x="3" y="103.8164"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="982" y1="103.8164" y2="103.8164"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="982" y1="106.8164" y2="106.8164"/><rect fill="#EEEEEE" filter="url(#fg6bcekwdl6lb)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="265" x="360" y="93.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="246" x="366" y="109.3169">AWB Tmp Conv: RunConvergence</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="617" y="109.3169"/><polygon fill="#FBFB77" filter="url(#fg6bcekwdl6lb)" points="98,131.3828,98,156.3828,313,156.3828,313,141.3828,303,131.3828,98,131.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="303" x2="303" y1="131.3828" y2="141.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="313" x2="303" y1="141.3828" y2="141.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="104" y="148.4497">after awbmain run</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="224" y="148.4497">RunAWB()</text><polygon fill="#A80036" points="190.5,182.5156,200.5,186.5156,190.5,190.5156,194.5,186.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="47.5" x2="196.5" y1="186.5156" y2="186.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="54.5" y="181.5825">RunConvergence()</text><polygon fill="#A80036" points="375.5,226.6484,385.5,230.6484,375.5,234.6484,379.5,230.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="212.5" x2="381.5" y1="230.6484" y2="230.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="156" x="219.5" y="210.7153">m_SCBasedConverge</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="219.5" y="225.8481">.Run</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="255.0469" y2="255.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="255.0469" y2="268.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="403.5" x2="444.5" y1="268.0469" y2="268.0469"/><polygon fill="#A80036" points="413.5,264.0469,403.5,268.0469,413.5,272.0469,409.5,268.0469" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="409.5" y="249.981">SetDetectorInput()</text><polygon fill="#FBFB77" filter="url(#fg6bcekwdl6lb)" points="407,286.0469,407,371.0469,620,371.0469,620,296.0469,610,286.0469,407,286.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="610" x2="610" y1="286.0469" y2="296.0469"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="620" x2="610" y1="296.0469" y2="296.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="413" y="303.1138">Set input to all detectors</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="413" y="318.2466">based on its type</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="413" y="333.3794">awbSCDTriggerType::PercGain</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="413" y="348.5122">awbSCDTriggerType::CCT</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="413" y="363.645">awbSCDTriggerType::Lux</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="402.5" x2="444.5" y1="406.8438" y2="406.8438"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="406.8438" y2="419.8438"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="419.8438" y2="419.8438"/><polygon fill="#A80036" points="407.5,415.8438,397.5,419.8438,407.5,423.8438,403.5,419.8438" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="409.5" y="401.7778">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="438.9766" y2="438.9766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="438.9766" y2="451.9766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="403.5" x2="444.5" y1="451.9766" y2="451.9766"/><polygon fill="#A80036" points="413.5,447.9766,403.5,451.9766,413.5,455.9766,409.5,451.9766" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="409.5" y="433.9106">RunDetectors()</text><polygon fill="#FBFB77" filter="url(#fg6bcekwdl6lb)" points="407,469.9766,407,539.9766,869,539.9766,869,479.9766,859,469.9766,407,469.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="859" x2="859" y1="469.9766" y2="479.9766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="869" x2="859" y1="479.9766" y2="479.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="413" y="487.0435">for PerGain type, the pSCDetector is</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="649" y="487.0435">CAWBSCDetectorGainsV1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="413" y="502.1763">for other type, the pSCDetector is</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="633" y="502.1763">CAWBSCDetectorV1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="441" x="413" y="517.3091">as the CAWBSCDetectorGainsV1 is derived from CAWBSCDetectorV1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="28" x="413" y="532.4419">take</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="445" y="532.4419">CAWBSCDetectorV1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="595" y="532.4419">as example</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="402.5" x2="449.5" y1="565.6406" y2="565.6406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449.5" x2="449.5" y1="565.6406" y2="578.6406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="408.5" x2="449.5" y1="578.6406" y2="578.6406"/><polygon fill="#A80036" points="418.5,574.6406,408.5,578.6406,418.5,582.6406,414.5,578.6406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="184" x="414.5" y="560.5747">CAWBSCDetectorV1::Run</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="407.5" x2="454.5" y1="607.7734" y2="607.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="454.5" x2="454.5" y1="607.7734" y2="620.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="413.5" x2="454.5" y1="620.7734" y2="620.7734"/><polygon fill="#A80036" points="423.5,616.7734,413.5,620.7734,423.5,624.7734,419.5,620.7734" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="419.5" y="602.7075">CAWBFilterV1::Run()</text><polygon fill="#FBFB77" filter="url(#fg6bcekwdl6lb)" points="417,638.7734,417,678.7734,685,678.7734,685,648.7734,675,638.7734,417,638.7734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="675" x2="675" y1="638.7734" y2="648.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="685" x2="675" y1="648.7734" y2="648.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="423" y="655.8403">1. history count reach 10 currently</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="423" y="670.9731">2. can run FIRFilter/MedianFilter/IIRFilter</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="412.5" x2="454.5" y1="714.1719" y2="714.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="454.5" x2="454.5" y1="714.1719" y2="727.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="407.5" x2="454.5" y1="727.1719" y2="727.1719"/><polygon fill="#A80036" points="417.5,723.1719,407.5,727.1719,417.5,731.1719,413.5,727.1719" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="419.5" y="709.106">return</text><rect fill="none" height="129.9922" style="stroke: #000000; stroke-width: 2.0;" width="394" x="402" y="737.1719"/><polygon fill="#EEEEEE" points="402,737.1719,466,737.1719,466,744.1719,456,754.1719,402,754.1719,402,737.1719" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="417" y="750.2388">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="481" y="749.3823">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="486" y="749.3823">FALSE == bHistoryFull</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="628" y="749.3823">]</text><polygon fill="#FBFB77" filter="url(#fg6bcekwdl6lb)" points="412,759.3047,412,784.3047,552,784.3047,552,769.3047,542,759.3047,412,759.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="542" x2="542" y1="759.3047" y2="769.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="552" x2="542" y1="769.3047" y2="769.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="418" y="776.3716">Rebase the history</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="402" x2="796" y1="794.4375" y2="794.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="407" y="804.6479">[</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="412" y="804.6479">TRUE == bHistoryFull</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="5" x="548" y="804.6479">]</text><polygon fill="#FBFB77" filter="url(#fg6bcekwdl6lb)" points="412,813.2422,412,857.2422,782,857.2422,782,823.2422,772,813.2422,412,813.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="772" x2="772" y1="813.2422" y2="823.2422"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="782" x2="772" y1="823.2422" y2="823.2422"/><text fill="#0000FF" font-family="sans-serif" font-size="15" lengthAdjust="spacingAndGlyphs" textLength="349" x="418" y="832.1655">if m_sceneChangeCount&gt;m_tuning.cosCountTh</text><text fill="#0000FF" font-family="sans-serif" font-size="15" lengthAdjust="spacingAndGlyphs" textLength="171" x="418" y="849.6265">bSceneChange = TRUE</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="407.5" x2="449.5" y1="900.2969" y2="900.2969"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="449.5" x2="449.5" y1="900.2969" y2="913.2969"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="402.5" x2="449.5" y1="913.2969" y2="913.2969"/><polygon fill="#A80036" points="412.5,909.2969,402.5,913.2969,412.5,917.2969,408.5,913.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="414.5" y="895.231">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="402.5" x2="444.5" y1="942.4297" y2="942.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="942.4297" y2="955.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="955.4297" y2="955.4297"/><polygon fill="#A80036" points="407.5,951.4297,397.5,955.4297,407.5,959.4297,403.5,955.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="409.5" y="937.3638">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="974.5625" y2="974.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="974.5625" y2="987.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="403.5" x2="444.5" y1="987.5625" y2="987.5625"/><polygon fill="#A80036" points="413.5,983.5625,403.5,987.5625,413.5,991.5625,409.5,987.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="409.5" y="969.4966">CAWBSCDBasedConvergeV1::</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="601.5" y="969.4966">Analyze()</text><polygon fill="#FBFB77" filter="url(#fg6bcekwdl6lb)" points="407,1005.5625,407,1045.5625,973,1045.5625,973,1015.5625,963,1005.5625,407,1005.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="963" x2="963" y1="1005.5625" y2="1015.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="973" x2="963" y1="1015.5625" y2="1015.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="545" x="413" y="1022.6294">1. count AWBSceneMonitor/AWBSceneChangeDetected/AWBSceneChangePostStable</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="413" y="1037.7622">2. got HoldingTime</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="402.5" x2="444.5" y1="1080.9609" y2="1080.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="1080.9609" y2="1093.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="1093.9609" y2="1093.9609"/><polygon fill="#A80036" points="407.5,1089.9609,397.5,1093.9609,407.5,1097.9609,403.5,1093.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="409.5" y="1075.895">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="1113.0938" y2="1113.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="1113.0938" y2="1126.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="403.5" x2="444.5" y1="1126.0938" y2="1126.0938"/><polygon fill="#A80036" points="413.5,1122.0938,403.5,1126.0938,413.5,1130.0938,409.5,1126.0938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="409.5" y="1108.0278">CAWBSCDBasedConvergeV1::</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="601.5" y="1108.0278">ComputeCF()</text><polygon fill="#FBFB77" filter="url(#fg6bcekwdl6lb)" points="407,1144.0938,407,1244.0938,850,1244.0938,850,1154.0938,840,1144.0938,407,1144.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="840" x2="840" y1="1144.0938" y2="1154.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="850" x2="840" y1="1154.0938" y2="1154.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="413" y="1161.1606">1. How we judge if converged?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="417" y="1176.2935">&gt;&gt;in</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="454" y="1176.2935">IsConverged</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="550" y="1176.2935">-&gt;</text><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="570" y="1176.2935">GetPercMaxGainChange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="417" y="1191.4263">&gt;&gt;if the diff &lt;= threshold,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="592" y="1191.4263">bConverged</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="682" y="1191.4263">=TRUE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="413" y="1206.5591">2. if  not converged, the Factor use</text><text fill="#008000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="154" x="640" y="1206.5591">fastConvBoostFactor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="419" x="413" y="1221.6919">3. if scene change detected, check holding time and select Factor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="422" x="413" y="1236.8247">4. For old AWB tuning, only have fast(0.6)/face(0.05)/normal factor</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="402.5" x2="444.5" y1="1280.0234" y2="1280.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="1280.0234" y2="1293.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="1293.0234" y2="1293.0234"/><polygon fill="#A80036" points="407.5,1289.0234,397.5,1293.0234,407.5,1297.0234,403.5,1293.0234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="409.5" y="1274.9575">return</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="1312.1563" y2="1312.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="1312.1563" y2="1325.1563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="403.5" x2="444.5" y1="1325.1563" y2="1325.1563"/><polygon fill="#A80036" points="413.5,1321.1563,403.5,1325.1563,413.5,1329.1563,409.5,1325.1563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="409.5" y="1307.0903">CAWBSCDBasedConvergeV1::</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="143" x="601.5" y="1307.0903">UpdateDebugInfo()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="402.5" x2="444.5" y1="1364.2891" y2="1364.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="444.5" x2="444.5" y1="1364.2891" y2="1377.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="397.5" x2="444.5" y1="1377.2891" y2="1377.2891"/><polygon fill="#A80036" points="407.5,1373.2891,397.5,1377.2891,407.5,1381.2891,403.5,1377.2891" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="409.5" y="1359.2231">return</text><polygon fill="#A80036" points="223.5,1397.2891,213.5,1401.2891,223.5,1405.2891,219.5,1401.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="217.5" x2="391.5" y1="1401.2891" y2="1401.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="229.5" y="1396.356">return</text><polygon fill="#A80036" points="58.5,1426.4219,48.5,1430.4219,58.5,1434.4219,54.5,1430.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="52.5" x2="206.5" y1="1430.4219" y2="1430.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="64.5" y="1425.4888">return</text><!--
@startuml
title <size:18>camx awb scenechangev1</size>

participant awbmain
participant awbtmpconvv1
participant awbscenechangev1

== **AWB Tmp Conv: RunConvergence** ==
note over awbtmpconvv1
  after awbmain run **RunAWB()**
end note
awbmain->awbtmpconvv1: **RunConvergence()**
activate awbtmpconvv1
  awbtmpconvv1->awbscenechangev1: **m_SCBasedConverge**\n**.Run**
  activate awbscenechangev1


    awbscenechangev1->awbscenechangev1: **SetDetectorInput()**
    note right awbscenechangev1
      Set input to all detectors
      based on its type
      <color:blue>awbSCDTriggerType::PercGain</color>
      <color:blue>awbSCDTriggerType::CCT</color>
      <color:blue>awbSCDTriggerType::Lux</color>
    end note
    activate awbscenechangev1 #Salmon
    awbscenechangev1->awbscenechangev1: return
    deactivate awbscenechangev1
  
    awbscenechangev1->awbscenechangev1: **RunDetectors()**
    note right awbscenechangev1
      for PerGain type, the pSCDetector is **CAWBSCDetectorGainsV1**
      for other type, the pSCDetector is **CAWBSCDetectorV1**
      as the CAWBSCDetectorGainsV1 is derived from CAWBSCDetectorV1
      take **CAWBSCDetectorV1** as example
    end note
    activate awbscenechangev1 #Salmon

      awbscenechangev1->awbscenechangev1: **CAWBSCDetectorV1::Run**
      activate awbscenechangev1
        
        awbscenechangev1->awbscenechangev1: **CAWBFilterV1::Run()**
        activate awbscenechangev1
          note right awbscenechangev1
            1. history count reach 10 currently
            2. can run FIRFilter/MedianFilter/IIRFilter
          end note
        awbscenechangev1->awbscenechangev1: return
        deactivate awbscenechangev1

        alt **FALSE == bHistoryFull**
          note right awbscenechangev1
            Rebase the history
          end note
        else **TRUE == bHistoryFull**
          note right awbscenechangev1
            <color:blue><size:15>if m_sceneChangeCount>m_tuning.cosCountTh</size></color>
            <color:blue><size:15>bSceneChange = TRUE</size></color>
          end note
        end
      awbscenechangev1->awbscenechangev1: return
      deactivate awbscenechangev1

    awbscenechangev1->awbscenechangev1: return
    deactivate awbscenechangev1

    awbscenechangev1->awbscenechangev1: CAWBSCDBasedConvergeV1::**Analyze()**
    activate awbscenechangev1 #Salmon
      note right awbscenechangev1
        1. count AWBSceneMonitor/AWBSceneChangeDetected/AWBSceneChangePostStable
        2. got HoldingTime
      end note
    awbscenechangev1->awbscenechangev1: return
    deactivate awbscenechangev1

    awbscenechangev1->awbscenechangev1: CAWBSCDBasedConvergeV1::**ComputeCF()**
    activate awbscenechangev1 #Salmon
      note right awbscenechangev1
        1. How we judge if converged?
         >>in **IsConverged** -> <color:green>**GetPercMaxGainChange**</color>
         >>if the diff <= threshold, **bConverged**=TRUE
        2. if  not converged, the Factor use <color:green>**fastConvBoostFactor**</color>
        3. if scene change detected, check holding time and select Factor
        4. For old AWB tuning, only have fast(0.6)/face(0.05)/normal factor
      end note
    awbscenechangev1->awbscenechangev1: return
    deactivate awbscenechangev1
    
    awbscenechangev1->awbscenechangev1: CAWBSCDBasedConvergeV1::**UpdateDebugInfo()**
    activate awbscenechangev1 #Salmon
    awbscenechangev1->awbscenechangev1: return
    deactivate awbscenechangev1

  awbscenechangev1->awbtmpconvv1: return
  deactivate awbscenechangev1
awbtmpconvv1->awbmain: return
deactivate awbtmpconvv1
@enduml

PlantUML version 1.2017.20(Mon Dec 11 16:57:05 GMT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_171-8u171-b11-0ubuntu0.16.04.1-b11
Operating System: Linux
OS Version: 4.4.0-43-Microsoft
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>